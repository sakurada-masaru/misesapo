<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <base href="/" />
    <title>立て替え精算申請 | ミセサポ</title>
    <link rel="icon" type="image/png" href="/images/logo_144x144.png" />
    <link rel="stylesheet" href="/styles.css" />
    <link rel="stylesheet" href="/css/header.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="/css/admin-sidebar.css">
    <link rel="stylesheet" href="/css/staff-reimbursements.css">

    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1000.0.min.js"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/amazon-cognito-identity-js@6.3.0/dist/amazon-cognito-identity.min.js"></script>
    <script src="/js/cognito_config.js"></script>
    <script src="/js/cognito_auth.js"></script>
    <script src="/js/client_auth.js"></script>
    <script src="/js/admin-sidebar.js"></script>
    <script src="/js/staff-reimbursements.js"></script>
</head>

<body class="theme-pink page-staff-reimbursements">
    <div id="default-header-wrapper">
        <header id="header-guest" class="site-header">
            <div class="inner wide">
                <div class="nav-left">
                    <a class="brand brand-logo" href="/">
                        <img src="/images/logo_144x144.png" alt="ミセサポ" />
                    </a>
                </div>
                <div class="spacer"></div>
                <nav class="nav-right">
                    <span class="role-badge" id="header-role-badge">スタッフ</span>
                    <button class="icon-btn" aria-label="通知"><i class="fas fa-bell"></i></button>
                </nav>
            </div>
        </header>
    </div>

    <div class="sidebar-overlay" id="sidebar-overlay"></div>
    <aside class="sidebar" id="admin-sidebar">
        <!-- サイドバーの内容はJavaScriptで制御されます -->
    </aside>

    <main id="main" class="main-content">
        <div class="container">
            <div class="page-header">
                <h1 class="page-title">立て替え精算申請</h1>
                <p class="page-subtitle">業務で立て替えた費用の精算を申請します。</p>
            </div>

            <div class="reimbursement-grid">
                <!-- 申請フォーム -->
                <div class="reimbursement-form-section">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-edit"></i> 新規申請</h3>
                        </div>
                        <form id="reimbursement-form" class="card-body">
                            <div class="form-group">
                                <label for="date">利用日 <span class="required">*</span></label>
                                <input type="date" id="date" required />
                            </div>

                            <div class="form-group">
                                <label for="category">カテゴリ <span class="required">*</span></label>
                                <select id="category" required>
                                    <option value="">選択してください</option>
                                    <option value="transportation">交通費</option>
                                    <option value="supplies">消耗品費</option>
                                    <option value="entertainment">接待交際費</option>
                                    <option value="travel">出張費</option>
                                    <option value="other">その他</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="title">項目名/内容 <span class="required">*</span></label>
                                <input type="text" id="title" placeholder="例：〇〇店への移動交通費" required />
                            </div>

                            <div class="form-group">
                                <label for="amount">金額（税込） <span class="required">*</span></label>
                                <div class="amount-input-wrapper">
                                    <span class="currency-unit">¥</span>
                                    <input type="number" id="amount" placeholder="0" min="1" required />
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="receipt">領収書・証憑アップロード <span class="required">*</span></label>
                                <div class="file-upload-area" id="receipt-drop-zone">
                                    <input type="file" id="receipt" accept="image/*,.pdf" style="display: none;" />
                                    <div class="upload-placeholder" id="upload-placeholder">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                        <p>クリックまたはドラッグ＆ドロップでアップロード</p>
                                        <span class="upload-hint">画像 (JPG, PNG) または PDF</span>
                                    </div>
                                    <div class="upload-preview" id="upload-preview" style="display: none;">
                                        <img id="preview-img" src="" alt="領収書プレビュー" />
                                        <button type="button" class="btn-remove-file" id="remove-file-btn">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="description">備考</label>
                                <textarea id="description" rows="3" placeholder="補足事項があれば入力してください"></textarea>
                            </div>

                            <div class="form-actions">
                                <button type="reset" class="btn btn-outline">リセット</button>
                                <button type="submit" class="btn btn-primary" id="submit-btn" disabled>
                                    <i class="fas fa-paper-plane"></i> 申請する
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- 申請履歴 -->
                <div class="reimbursement-history-section">
                    <div class="card">
                        <div class="card-header">
                            <h3><i class="fas fa-history"></i> 申請履歴（直近1ヶ月）</h3>
                            <div class="header-actions">
                                <button class="btn btn-text btn-sm" id="refresh-history">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="history-list" id="history-list">
                                <div class="loading"><i class="fas fa-spinner fa-spin"></i> 読み込み中...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container text-center muted small">
            <p>&copy; 2025 ミセサポ</p>
        </div>
    </footer>

    <!-- 成功/エラーメッセージ用トースト -->
    <div id="toast-container" class="toast-container"></div>
</body>

</html>