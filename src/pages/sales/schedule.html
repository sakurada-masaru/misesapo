@layout('layouts.base')
@json('data/meta/sales_schedule_title.json', $title)
@json('data/meta/sales_schedule_body_class.json', $body_class)
@json('data/sales_schedule.json', schedule_data)
@json('data/clients.json', clients_data)

<main id="main" class="google-calendar-wrapper">
  <!-- Sidebar Overlay -->
  <div class="sidebar-overlay" id="sidebar-overlay"></div>
  
  <!-- Left Sidebar -->
  <aside class="calendar-sidebar">
    <div class="sidebar-header">
      <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
        <a href="/sales/dashboard.html" class="back-btn-sidebar">
          <i class="fas fa-chevron-left"></i>
        </a>
        <button class="sidebar-close-btn" id="sidebar-close">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <button class="create-btn">
        <i class="fas fa-plus"></i> 作成
      </button>
    </div>
    
    <div class="sidebar-content">
      <!-- Search -->
      <div class="search-box">
        <i class="fas fa-search"></i>
        <input type="text" placeholder="検索" id="calendar-search">
      </div>

      <!-- View Tabs -->
      <div class="view-tabs-sidebar">
        <button class="view-tab-sidebar active" data-view="month">
          <i class="fas fa-calendar-alt"></i> 月
        </button>
        <button class="view-tab-sidebar" data-view="week">
          <i class="fas fa-calendar-week"></i> 週
        </button>
        <button class="view-tab-sidebar" data-view="day">
          <i class="fas fa-calendar-day"></i> 日
        </button>
      </div>

      <!-- Calendar List -->
      <div class="calendar-list">
        <div class="calendar-list-header">
          <h3>カレンダー</h3>
        </div>
        <div class="calendar-list-items" id="calendar-list-items">
          <!-- Calendar items will be generated by JavaScript -->
        </div>
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <div class="calendar-main">
    <!-- Top Bar -->
    <div class="calendar-topbar">
      <div class="topbar-left">
        <button class="menu-toggle" id="menu-toggle">
          <i class="fas fa-bars"></i>
        </button>
        <div class="date-navigation">
          <button class="nav-btn-icon" id="prev-btn">
            <i class="fas fa-chevron-left"></i>
          </button>
          <button class="nav-btn-icon" id="next-btn">
            <i class="fas fa-chevron-right"></i>
          </button>
          <button class="today-btn-google" id="today-btn">今日</button>
          <h2 class="current-date-title" id="current-date-title">2025年3月</h2>
        </div>
      </div>
      <div class="topbar-right">
        <button class="icon-btn" id="settings-btn" title="設定">
          <i class="fas fa-cog"></i>
        </button>
      </div>
    </div>

    <!-- Month View -->
    <div class="calendar-view" id="month-view">
      <div class="calendar-grid-month">
        <div class="calendar-weekdays-month">
          <div class="weekday-month">日</div>
          <div class="weekday-month">月</div>
          <div class="weekday-month">火</div>
          <div class="weekday-month">水</div>
          <div class="weekday-month">木</div>
          <div class="weekday-month">金</div>
          <div class="weekday-month">土</div>
        </div>
        <div class="calendar-days-month" id="calendar-days-month">
          <!-- Calendar days will be generated by JavaScript -->
        </div>
      </div>
    </div>

    <!-- Week View -->
    <div class="calendar-view hidden" id="week-view">
      <div class="calendar-grid-week">
        <div class="time-column">
          <div class="time-header"></div>
          <div class="time-slots" id="time-slots-week">
            <!-- Time slots will be generated by JavaScript -->
          </div>
        </div>
        <div class="days-column">
          <div class="days-header" id="days-header-week">
            <!-- Day headers will be generated by JavaScript -->
          </div>
          <div class="days-content" id="days-content-week">
            <!-- Day columns will be generated by JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <!-- Day View -->
    <div class="calendar-view hidden" id="day-view">
      <div class="calendar-grid-day">
        <div class="time-column">
          <div class="time-header"></div>
          <div class="time-slots" id="time-slots-day">
            <!-- Time slots will be generated by JavaScript -->
          </div>
        </div>
        <div class="day-column">
          <div class="day-header" id="day-header-day">
            <!-- Day header will be generated by JavaScript -->
          </div>
          <div class="day-content" id="day-content-day">
            <!-- Day content will be generated by JavaScript -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Schedule Modal -->
  <div class="modal-overlay hidden" id="schedule-modal">
    <div class="modal-content-google">
      <div class="modal-header-google">
        <h3 id="modal-title">スケジュール</h3>
        <button class="modal-close-google" id="modal-close">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <form id="schedule-form">
        <input type="hidden" id="schedule-id" name="id">
        
        <div class="form-group-google">
          <label>タイトル</label>
          <input type="text" id="schedule-title" name="title" class="form-input-google" required>
        </div>

        <div class="form-row-google">
          <div class="form-group-google">
            <label>日付</label>
            <input type="date" id="schedule-date" name="date" class="form-input-google" required>
          </div>
          <div class="form-group-google">
            <label>開始時刻</label>
            <input type="time" id="schedule-time-start" name="time_start" class="form-input-google" required>
          </div>
          <div class="form-group-google">
            <label>終了時刻</label>
            <input type="time" id="schedule-time-end" name="time_end" class="form-input-google" required>
          </div>
        </div>

        <div class="form-group-google">
          <label>カレンダー</label>
          <select id="schedule-calendar-type" name="calendar_type" class="form-input-google">
            <option value="見積もり提出">見積もり提出</option>
            <option value="商談">商談</option>
            <option value="定期訪問">定期訪問</option>
            <option value="清掃状況確認">清掃状況確認</option>
            <option value="その他">その他</option>
          </select>
        </div>

        <div class="form-group-google">
          <label>顧客</label>
          <select id="schedule-client" name="client_id" class="form-input-google">
            <option value="">選択してください</option>
          </select>
        </div>

        <div class="form-group-google">
          <label>店舗</label>
          <input type="text" id="schedule-store" name="store_name" class="form-input-google" placeholder="店舗名を入力">
        </div>

        <div class="form-group-google">
          <label>住所</label>
          <input type="text" id="schedule-address" name="address" class="form-input-google" placeholder="住所を入力">
        </div>

        <div class="form-group-google">
          <label>備考</label>
          <textarea id="schedule-notes" name="notes" class="form-input-google form-textarea-google" rows="3"></textarea>
        </div>

        <div class="form-actions-google">
          <button type="button" class="btn-cancel" id="modal-cancel">キャンセル</button>
          <button type="button" class="btn-delete hidden" id="modal-delete">削除</button>
          <button type="submit" class="btn-save">保存</button>
        </div>
      </form>
    </div>
  </div>

  <link rel="stylesheet" href="/css/schedule.css">
  <script type="application/json" id="schedule-data">@jsonvar schedule_data</script>
  <script type="application/json" id="clients-data">@jsonvar clients_data</script>
  <script src="/js/schedule.js"></script>
</main>
