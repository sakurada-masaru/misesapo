<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base href="/" />
    <title>スケジュール管理 | ミセサポ</title>
    <link rel="icon" type="image/png" href="/images/logo_144x144.png" />
<link rel="shortcut icon" href="/images/logo_144x144.png" />
<link rel="apple-touch-icon" href="/images/logo_144x144.png" />
<link rel="stylesheet" href="/styles.css" />
<link rel="stylesheet" href="/css/header.css" />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<!-- 
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet" />
-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<style>
  body { font-family: 'Noto Sans JP', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', Meiryo, sans-serif; }
  /* Brand theme variables (default + variants) */
  body { --primary: #FF679C; --primary-600: #E35687; }
  body.theme-pink { --primary: #FF679C; --primary-600: #E35687; }
  body.theme-blue { --primary: #2563eb; --primary-600: #1d4ed8; }
  body.theme-emerald { --primary: #10b981; --primary-600: #059669; }
  /* Note: :root also defines the same brand color; inline vars ensure early paint */
  </style>

  </head>
  <body class="theme-pink page-sales-schedule">
    <div id="default-header-wrapper">
    <a class="skip-link" href="#main">メインコンテンツへスキップ</a>
<header id="header-guest" class="site-header" data-role="guest">
  <div class="inner wide">
    <div class="nav-left">
      <a class="brand brand-logo" href="/index.html" aria-label="ミセサポ ホーム">
        <img src="/images/logo_144x144.png" alt="ミセサポ" />
      </a>
      <nav id="nav-guest" class="nav-left hide-sm" aria-label="Primary">
        <!-- ナビゲーション項目はJavaScriptで動的に生成されます -->
      </nav>
    </div>
    <div class="spacer"></div>
    <nav class="nav-right hide-sm" aria-label="User">
      <span class="role-badge" style="padding: 4px 12px; background: #e5e7eb; color: #6b7280; border-radius: 4px; font-size: 0.875rem; font-weight: 500;">ゲスト</span>
      <a class="nav-link" href="/signin.html">ログイン</a>
      <a class="nav-link primary" href="/signup.html">新規登録</a>
      <button class="icon-btn" aria-label="通知">
        <i class="fas fa-bell"></i>
      </button>
      <button class="icon-btn" aria-label="ログアウト" onclick="window.Auth && window.Auth.logout()" style="display: none;">
        <i class="fas fa-sign-out-alt"></i>
      </button>
    </nav>
    <button class="hamburger-btn show-sm" aria-label="メニュー" aria-expanded="false" id="hamburger-btn">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </div>
  <!-- スマホ版ナビゲーションメニュー -->
  <nav class="mobile-nav show-sm" id="mobile-nav" aria-label="モバイルナビゲーション">
    <div class="mobile-nav-content">
      <nav class="mobile-nav-primary" id="mobile-nav-primary" aria-label="Primary">
        <!-- ナビゲーション項目はJavaScriptで動的に生成されます -->
      </nav>
      <nav class="mobile-nav-user" aria-label="User">
        <span class="role-badge" style="padding: 4px 12px; background: #e5e7eb; color: #6b7280; border-radius: 4px; font-size: 0.875rem; font-weight: 500;">ゲスト</span>
        <a class="mobile-nav-link" href="/signin.html">ログイン</a>
        <a class="mobile-nav-link primary" href="/signup.html">新規登録</a>
      </nav>
    </div>
  </nav>
</header>

    </div>
    <!-- 通常ヘッダー（ログイン画面用） -->
    <div id="normal-header-wrapper" style="display: none;">
    <!-- 通常ヘッダー -->
<header class="normal-header">
    <div class="normal-header-inner">
        <div class="normal-header-logo">
            <a href="/">
                <img id="normal-header-logo-img" src="/images-material/logo_144x144.png" alt="ロゴ" onerror="this.style.display='none'">
            </a>
                </div>
        <nav class="normal-header-nav">
            <a href="/">TOP</a>
            <a href="/service.html">対応可能サービス</a>
            <a href="/lp.html#voice">お客様の声</a>
            <a href="/customers-support-desk.html">カスタマーズサポート</a>
            <a href="/announcements.html">お知らせ</a>
            <a href="/privacy-policy.html">規約＆ポリシー</a>
        </nav>
        <div class="normal-header-actions">
            <a href="/signin.html" class="normal-header-login">ログイン</a>
        </div>
            </div>
</header>


    </div>
    <main id="main">
      





<main id="main" class="google-calendar-wrapper">
  <!-- Left Sidebar -->
  <aside class="calendar-sidebar">
    <div class="sidebar-header">
      <a href="/sales/dashboard.html" class="back-btn-sidebar">
        <i class="fas fa-chevron-left"></i>
      </a>
      <button class="create-btn">
        <i class="fas fa-plus"></i> 作成
      </button>
    </div>
    
    <div class="sidebar-content">
      <!-- Search -->
      <div class="search-box">
        <i class="fas fa-search"></i>
        <input type="text" placeholder="検索" id="calendar-search">
      </div>

      <!-- View Tabs -->
      <div class="view-tabs-sidebar">
        <button class="view-tab-sidebar active" data-view="month">
          <i class="fas fa-calendar-alt"></i> 月
        </button>
        <button class="view-tab-sidebar" data-view="week">
          <i class="fas fa-calendar-week"></i> 週
        </button>
        <button class="view-tab-sidebar" data-view="day">
          <i class="fas fa-calendar-day"></i> 日
        </button>
      </div>

      <!-- Calendar List -->
      <div class="calendar-list">
        <div class="calendar-list-header">
          <h3>カレンダー</h3>
        </div>
        <div class="calendar-list-items" id="calendar-list-items">
          <!-- Calendar items will be generated by JavaScript -->
        </div>
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <div class="calendar-main">
    <!-- Top Bar -->
    <div class="calendar-topbar">
      <div class="topbar-left">
        <button class="menu-toggle" id="menu-toggle">
          <i class="fas fa-bars"></i>
        </button>
        <div class="date-navigation">
          <button class="nav-btn-icon" id="prev-btn">
            <i class="fas fa-chevron-left"></i>
          </button>
          <button class="nav-btn-icon" id="next-btn">
            <i class="fas fa-chevron-right"></i>
          </button>
          <button class="today-btn-google" id="today-btn">今日</button>
          <h2 class="current-date-title" id="current-date-title">2025年3月</h2>
        </div>
      </div>
      <div class="topbar-right">
        <button class="icon-btn" id="settings-btn" title="設定">
          <i class="fas fa-cog"></i>
        </button>
      </div>
    </div>

    <!-- Month View -->
    <div class="calendar-view" id="month-view">
      <div class="calendar-grid-month">
        <div class="calendar-weekdays-month">
          <div class="weekday-month">日</div>
          <div class="weekday-month">月</div>
          <div class="weekday-month">火</div>
          <div class="weekday-month">水</div>
          <div class="weekday-month">木</div>
          <div class="weekday-month">金</div>
          <div class="weekday-month">土</div>
        </div>
        <div class="calendar-days-month" id="calendar-days-month">
          <!-- Calendar days will be generated by JavaScript -->
        </div>
      </div>
    </div>

    <!-- Week View -->
    <div class="calendar-view hidden" id="week-view">
      <div class="calendar-grid-week">
        <div class="time-column">
          <div class="time-header"></div>
          <div class="time-slots" id="time-slots-week">
            <!-- Time slots will be generated by JavaScript -->
          </div>
        </div>
        <div class="days-column">
          <div class="days-header" id="days-header-week">
            <!-- Day headers will be generated by JavaScript -->
          </div>
          <div class="days-content" id="days-content-week">
            <!-- Day columns will be generated by JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <!-- Day View -->
    <div class="calendar-view hidden" id="day-view">
      <div class="calendar-grid-day">
        <div class="time-column">
          <div class="time-header"></div>
          <div class="time-slots" id="time-slots-day">
            <!-- Time slots will be generated by JavaScript -->
          </div>
        </div>
        <div class="day-column">
          <div class="day-header" id="day-header-day">
            <!-- Day header will be generated by JavaScript -->
          </div>
          <div class="day-content" id="day-content-day">
            <!-- Day content will be generated by JavaScript -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Schedule Modal -->
  <div class="modal-overlay hidden" id="schedule-modal">
    <div class="modal-content-google">
      <div class="modal-header-google">
        <h3 id="modal-title">スケジュール</h3>
        <button class="modal-close-google" id="modal-close">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <form id="schedule-form">
        <input type="hidden" id="schedule-id" name="id">
        
        <div class="form-group-google">
          <label>タイトル</label>
          <input type="text" id="schedule-title" name="title" class="form-input-google" required>
        </div>

        <div class="form-row-google">
          <div class="form-group-google">
            <label>日付</label>
            <input type="date" id="schedule-date" name="date" class="form-input-google" required>
          </div>
          <div class="form-group-google">
            <label>開始時刻</label>
            <input type="time" id="schedule-time-start" name="time_start" class="form-input-google" required>
          </div>
          <div class="form-group-google">
            <label>終了時刻</label>
            <input type="time" id="schedule-time-end" name="time_end" class="form-input-google" required>
          </div>
        </div>

        <div class="form-group-google">
          <label>カレンダー</label>
          <select id="schedule-calendar-type" name="calendar_type" class="form-input-google">
            <option value="見積もり提出">見積もり提出</option>
            <option value="商談">商談</option>
            <option value="定期訪問">定期訪問</option>
            <option value="清掃状況確認">清掃状況確認</option>
            <option value="その他">その他</option>
          </select>
        </div>

        <div class="form-group-google">
          <label>顧客</label>
          <select id="schedule-client" name="client_id" class="form-input-google">
            <option value="">選択してください</option>
          </select>
        </div>

        <div class="form-group-google">
          <label>店舗</label>
          <input type="text" id="schedule-store" name="store_name" class="form-input-google" placeholder="店舗名を入力">
        </div>

        <div class="form-group-google">
          <label>住所</label>
          <input type="text" id="schedule-address" name="address" class="form-input-google" placeholder="住所を入力">
        </div>

        <div class="form-group-google">
          <label>備考</label>
          <textarea id="schedule-notes" name="notes" class="form-input-google form-textarea-google" rows="3"></textarea>
        </div>

        <div class="form-actions-google">
          <button type="button" class="btn-cancel" id="modal-cancel">キャンセル</button>
          <button type="button" class="btn-delete hidden" id="modal-delete">削除</button>
          <button type="submit" class="btn-save">保存</button>
        </div>
      </form>
    </div>
  </div>

  <style>
    /* Reset and Base */
    body.page-sales-schedule {
      margin: 0;
      padding: 0;
      overflow: hidden;
    }
    body.page-sales-schedule #default-header-wrapper,
    body.page-sales-schedule #normal-header-wrapper,
    body.page-sales-schedule .site-footer {
      display: none !important;
    }
    
    .google-calendar-wrapper {
      display: flex;
      height: 100vh;
      width: 100vw;
      overflow: hidden;
      background: #fff;
      font-family: 'Google Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    /* Back Button (hidden on desktop, shown in sidebar) */
    .back-btn-google {
      display: none;
    }

    /* Sidebar */
    .calendar-sidebar {
      width: 256px;
      background: #fff;
      border-right: 1px solid #dadce0;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      transition: transform 0.3s;
    }
    .sidebar-header {
      padding: 16px;
      border-bottom: 1px solid #dadce0;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .back-btn-sidebar {
      width: 100%;
      padding: 8px 16px;
      background: #f8f9fa;
      color: #5f6368;
      text-decoration: none;
      border: 1px solid #dadce0;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.2s;
    }
    .back-btn-sidebar:hover {
      background: #e8eaed;
      color: #202124;
    }
    @media (max-width: 768px) {
      .back-btn-sidebar {
        display: none;
      }
    }
    .create-btn {
      width: 100%;
      padding: 12px 24px;
      background: #1a73e8;
      color: #fff;
      border: none;
      border-radius: 24px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.2s;
      box-shadow: 0 1px 2px rgba(60,64,67,0.3);
    }
    .create-btn:hover {
      background: #1557b0;
      box-shadow: 0 2px 4px rgba(60,64,67,0.3);
    }
    .sidebar-content {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
    }
    .search-box {
      position: relative;
      margin-bottom: 16px;
    }
    .search-box i {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: #5f6368;
      font-size: 14px;
    }
    .search-box input {
      width: 100%;
      padding: 10px 12px 10px 36px;
      border: 1px solid #dadce0;
      border-radius: 8px;
      font-size: 14px;
      transition: all 0.2s;
    }
    .search-box input:focus {
      outline: none;
      border-color: #1a73e8;
      box-shadow: 0 0 0 2px rgba(26,115,232,0.1);
    }
    .view-tabs-sidebar {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-bottom: 24px;
    }
    .view-tab-sidebar {
      padding: 10px 16px;
      border: none;
      background: transparent;
      text-align: left;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      color: #5f6368;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.2s;
    }
    .view-tab-sidebar:hover {
      background: #f1f3f4;
    }
    .view-tab-sidebar.active {
      background: #e8f0fe;
      color: #1a73e8;
      font-weight: 500;
    }
    .calendar-list-header h3 {
      font-size: 13px;
      font-weight: 500;
      color: #5f6368;
      margin: 0 0 8px 0;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .calendar-list-items {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .calendar-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 8px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .calendar-item:hover {
      background: #f1f3f4;
    }
    .calendar-color {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      flex-shrink: 0;
    }
    .calendar-name {
      flex: 1;
      font-size: 14px;
      color: #202124;
    }
    .calendar-toggle {
      width: 18px;
      height: 18px;
      border: 2px solid #dadce0;
      border-radius: 4px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }
    .calendar-item.hidden .calendar-toggle {
      background: #fff;
    }
    .calendar-item:not(.hidden) .calendar-toggle {
      background: #1a73e8;
      border-color: #1a73e8;
    }
    .calendar-item:not(.hidden) .calendar-toggle::after {
      content: '✓';
      color: #fff;
      font-size: 12px;
    }

    /* Main Content */
    .calendar-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      position: relative;
    }
    .calendar-topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 16px;
      border-bottom: 1px solid #dadce0;
      background: #fff;
    }
    .topbar-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .menu-toggle {
      width: 40px;
      height: 40px;
      border: none;
      background: transparent;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #5f6368;
      transition: all 0.2s;
    }
    .menu-toggle:hover {
      background: #f1f3f4;
    }
    .date-navigation {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .nav-btn-icon {
      width: 40px;
      height: 40px;
      border: none;
      background: transparent;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #5f6368;
      transition: all 0.2s;
    }
    .nav-btn-icon:hover {
      background: #f1f3f4;
    }
    .today-btn-google {
      padding: 8px 16px;
      border: 1px solid #dadce0;
      background: #fff;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      color: #5f6368;
      cursor: pointer;
      transition: all 0.2s;
    }
    .today-btn-google:hover {
      background: #f8f9fa;
    }
    .current-date-title {
      font-size: 22px;
      font-weight: 400;
      color: #202124;
      margin: 0;
      min-width: 200px;
    }
    .topbar-right {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .icon-btn {
      width: 40px;
      height: 40px;
      border: none;
      background: transparent;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #5f6368;
      transition: all 0.2s;
    }
    .icon-btn:hover {
      background: #f1f3f4;
    }

    /* Calendar Views */
    .calendar-view {
      flex: 1;
      overflow: auto;
      background: #fff;
    }
    .calendar-view.hidden {
      display: none;
    }

    /* Month View */
    .calendar-grid-month {
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    .calendar-weekdays-month {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      border-bottom: 1px solid #dadce0;
      background: #fff;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .weekday-month {
      padding: 8px 4px;
      text-align: center;
      font-size: 10px;
      font-weight: 500;
      color: #5f6368;
      text-transform: uppercase;
    }
    .calendar-days-month {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      flex: 1;
      border-right: 1px solid #dadce0;
      border-bottom: 1px solid #dadce0;
    }
    .calendar-day-month {
      min-height: 80px;
      border-left: 1px solid #dadce0;
      border-top: 1px solid #dadce0;
      padding: 4px;
      position: relative;
      cursor: pointer;
      transition: background 0.2s;
    }
    .calendar-day-month:hover {
      background: #f8f9fa;
    }
    .calendar-day-month.other-month {
      background: #f8f9fa;
      color: #9aa0a6;
    }
    .calendar-day-month.today {
      background: #e8f0fe;
    }
    .day-number {
      font-size: 12px;
      font-weight: 500;
      color: #202124;
      margin-bottom: 2px;
    }
    .calendar-day-month.today .day-number {
      color: #1a73e8;
      font-weight: 700;
    }
    .day-events {
      display: flex;
      flex-direction: column;
      gap: 1px;
      margin-top: 2px;
    }
    .day-event {
      padding: 1px 4px;
      border-radius: 2px;
      font-size: 10px;
      cursor: pointer;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      border-left: 2px solid;
      transition: all 0.2s;
    }
    .day-event:hover {
      box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }
    .day-event-more {
      font-size: 10px;
      color: #5f6368;
      padding: 1px 4px;
      cursor: pointer;
    }
    .day-event-more:hover {
      background: #f1f3f4;
      border-radius: 3px;
    }

    /* Week View */
    .calendar-grid-week {
      display: flex;
      height: 100%;
    }
    .time-column {
      width: 50px;
      border-right: 1px solid #dadce0;
      background: #fff;
      position: sticky;
      left: 0;
      z-index: 5;
      flex-shrink: 0;
    }
    .time-header {
      height: 48px;
      border-bottom: 1px solid #dadce0;
    }
    .time-slots {
      display: flex;
      flex-direction: column;
    }
    .time-slot {
      height: 40px;
      border-bottom: 1px solid #e8eaed;
      display: flex;
      align-items: flex-start;
      justify-content: flex-end;
      padding-right: 8px;
      padding-top: 2px;
      font-size: 11px;
      color: #5f6368;
    }
    .days-column {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow-x: auto;
    }
    .days-header {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      border-bottom: 1px solid #dadce0;
      background: #fff;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .day-header {
      padding: 8px 4px;
      text-align: center;
      border-right: 1px solid #dadce0;
    }
    .day-header.today {
      background: #e8f0fe;
    }
    .day-header-name {
      font-size: 11px;
      color: #5f6368;
      text-transform: uppercase;
      margin-bottom: 4px;
    }
    .day-header-number {
      font-size: 20px;
      font-weight: 400;
      color: #202124;
    }
    .day-header.today .day-header-number {
      color: #1a73e8;
      font-weight: 500;
    }
    .days-content {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      flex: 1;
    }
    .day-column-week {
      border-right: 1px solid #dadce0;
      position: relative;
    }
    .day-column-week .day-time-slot {
      height: 40px;
      border-bottom: 1px solid #e8eaed;
      position: relative;
      cursor: pointer;
    }
    .day-column-week .day-time-slot:hover {
      background: #f8f9fa;
    }
    .week-event {
      position: absolute;
      left: 1px;
      right: 1px;
      padding: 2px 4px;
      border-radius: 3px;
      font-size: 10px;
      cursor: move;
      overflow: hidden;
      border-left: 2px solid;
      z-index: 1;
      user-select: none;
      transition: box-shadow 0.2s;
    }
    .week-event:hover {
      z-index: 2;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    .week-event.dragging {
      opacity: 0.7;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    .week-event .resize-handle {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 4px;
      cursor: ns-resize;
      background: rgba(0,0,0,0.1);
      border-radius: 0 0 4px 4px;
    }
    .week-event .resize-handle:hover {
      background: rgba(0,0,0,0.2);
    }
    .week-event .resize-handle-top {
      top: 0;
      bottom: auto;
      border-radius: 4px 4px 0 0;
    }

    /* Day View */
    .calendar-grid-day {
      display: flex;
      height: 100%;
    }
    .day-column {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .day-header {
      padding: 12px;
      text-align: center;
      border-bottom: 1px solid #dadce0;
      background: #fff;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .day-content {
      flex: 1;
      position: relative;
    }
    .day-content .day-time-slot {
      height: 40px;
      border-bottom: 1px solid #e8eaed;
      position: relative;
      cursor: pointer;
    }
    .day-content .day-time-slot:hover {
      background: #f8f9fa;
    }
    .day-event {
      padding: 8px 12px;
      margin-bottom: 8px;
      border-radius: 6px;
      cursor: move;
      border-left: 4px solid;
      transition: all 0.2s;
      user-select: none;
    }
    .day-event:hover {
      transform: translateX(4px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .day-event.dragging {
      opacity: 0.7;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    /* Calendar Colors */
    .calendar-color.purpose-見積もり提出 { background: #4285f4; }
    .calendar-color.purpose-商談 { background: #fbbc04; }
    .calendar-color.purpose-定期訪問 { background: #34a853; }
    .calendar-color.purpose-清掃状況確認 { background: #ea4335; }
    .calendar-color.purpose-その他 { background: #9aa0a6; }

    .day-event.purpose-見積もり提出,
    .week-event.purpose-見積もり提出 {
      background: #e8f0fe;
      border-left-color: #4285f4;
      color: #1967d2;
    }
    .day-event.purpose-商談,
    .week-event.purpose-商談 {
      background: #fef7e0;
      border-left-color: #fbbc04;
      color: #f9ab00;
    }
    .day-event.purpose-定期訪問,
    .week-event.purpose-定期訪問 {
      background: #e6f4ea;
      border-left-color: #34a853;
      color: #137333;
    }
    .day-event.purpose-清掃状況確認,
    .week-event.purpose-清掃状況確認 {
      background: #fce8e6;
      border-left-color: #ea4335;
      color: #c5221f;
    }
    .day-event.purpose-その他,
    .week-event.purpose-その他 {
      background: #f1f3f4;
      border-left-color: #9aa0a6;
      color: #5f6368;
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }
    .modal-overlay.hidden {
      display: none;
    }
    .modal-content-google {
      background: #fff;
      border-radius: 8px;
      width: 90%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 8px 10px 1px rgba(0,0,0,0.14), 0 3px 14px 2px rgba(0,0,0,0.12);
    }
    .modal-header-google {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 24px;
      border-bottom: 1px solid #dadce0;
    }
    .modal-header-google h3 {
      font-size: 20px;
      font-weight: 400;
      margin: 0;
      color: #202124;
    }
    .modal-close-google {
      width: 40px;
      height: 40px;
      border: none;
      background: transparent;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #5f6368;
      transition: all 0.2s;
    }
    .modal-close-google:hover {
      background: #f1f3f4;
    }
    .form-group-google {
      margin-bottom: 16px;
      padding: 0 24px;
    }
    .form-row-google {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 16px;
      padding: 0 24px;
      margin-bottom: 16px;
    }
    .form-group-google label {
      display: block;
      font-size: 13px;
      font-weight: 500;
      color: #5f6368;
      margin-bottom: 4px;
    }
    .form-input-google {
      width: 100%;
      padding: 8px 12px;
      border: 1px solid #dadce0;
      border-radius: 4px;
      font-size: 14px;
      color: #202124;
      transition: all 0.2s;
    }
    .form-input-google:focus {
      outline: none;
      border-color: #1a73e8;
      box-shadow: 0 0 0 2px rgba(26,115,232,0.1);
    }
    .form-textarea-google {
      resize: vertical;
      min-height: 80px;
    }
    .form-actions-google {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 8px;
      padding: 16px 24px;
      border-top: 1px solid #dadce0;
      margin-top: 24px;
    }
    .btn-cancel,
    .btn-delete,
    .btn-save {
      padding: 8px 24px;
      border: none;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-cancel {
      background: transparent;
      color: #5f6368;
    }
    .btn-cancel:hover {
      background: #f1f3f4;
    }
    .btn-delete {
      background: transparent;
      color: #ea4335;
      margin-right: auto;
    }
    .btn-delete:hover {
      background: #fce8e6;
    }
    .btn-save {
      background: #1a73e8;
      color: #fff;
    }
    .btn-save:hover {
      background: #1557b0;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .calendar-sidebar {
        position: fixed;
        left: 0;
        top: 0;
        bottom: 0;
        z-index: 1000;
        transform: translateX(-100%);
      }
      .calendar-sidebar.open {
        transform: translateX(0);
      }
      .calendar-main {
        width: 100%;
        padding: 0;
      }
      .calendar-topbar {
        padding: 8px 12px;
      }
      .calendar-view {
        padding: 0;
      }
      .calendar-weekdays-month {
        padding: 0;
      }
      .weekday-month {
        padding: 8px 2px;
      }
      .calendar-days-month {
        padding: 0;
      }
      .days-header {
        padding: 0;
      }
      .day-header {
        padding: 8px 2px;
      }
      .day-header-day {
        padding: 8px 12px;
      }
      .current-date-title {
        font-size: 18px;
        min-width: auto;
      }
      .form-row-google {
        grid-template-columns: 1fr;
      }
      .calendar-days-month {
        padding: 0;
      }
      .calendar-day-month {
        padding: 4px 2px;
      }
      .days-content {
        padding: 0;
      }
      .day-content {
        padding: 0;
      }
    }
  </style>

  <script type="application/json" id="schedule-data">{"schedules": [{"id": 1, "date": "2025-11-23", "time": "09:00", "client_name": "株式会社ABC", "store_name": "ABC店", "purpose": "定期清掃", "address": "東京都渋谷区1-1-1", "phone": "03-1234-5678", "email": "abc@example.com", "status": "pending"}, {"id": 2, "date": "2025-11-23", "time": "14:00", "client_name": "株式会社XYZ", "store_name": "XYZ店", "purpose": "エアコン清掃", "address": "東京都新宿区2-2-2", "phone": "03-2345-6789", "email": "xyz@example.com", "status": "pending"}, {"id": 3, "date": "2025-11-24", "time": "10:00", "client_name": "株式会社DEF", "store_name": "DEF店", "purpose": "害虫駆除", "address": "東京都港区3-3-3", "phone": "03-3456-7890", "email": "def@example.com", "status": "pending"}, {"id": 4, "date": "2025-11-24", "time": "15:00", "client_name": "株式会社GHI", "store_name": "GHI店", "purpose": "定期清掃", "address": "東京都品川区4-4-4", "phone": "03-4567-8901", "email": "ghi@example.com", "status": "pending"}, {"id": 5, "date": "2025-11-25", "time": "08:00", "client_name": "株式会社JKL", "store_name": "JKL店", "purpose": "床清掃", "address": "東京都目黒区5-5-5", "phone": "03-5678-9012", "email": "jkl@example.com", "status": "pending"}, {"id": 6, "date": "2025-11-25", "time": "13:00", "client_name": "株式会社MNO", "store_name": "MNO店", "purpose": "トイレ清掃", "address": "東京都世田谷区6-6-6", "phone": "03-6789-0123", "email": "mno@example.com", "status": "pending"}, {"id": 7, "date": "2025-11-25", "time": "18:00", "client_name": "株式会社PQR", "store_name": "PQR店", "purpose": "定期清掃", "address": "東京都大田区7-7-7", "phone": "03-7890-1234", "email": "pqr@example.com", "status": "pending"}, {"id": 8, "date": "2025-11-26", "time": "11:00", "client_name": "株式会社STU", "store_name": "STU店", "purpose": "エアコン清掃", "address": "東京都杉並区8-8-8", "phone": "03-8901-2345", "email": "stu@example.com", "status": "pending"}, {"id": 9, "date": "2025-11-26", "time": "16:00", "client_name": "株式会社VWX", "store_name": "VWX店", "purpose": "害虫駆除", "address": "東京都中野区9-9-9", "phone": "03-9012-3456", "email": "vwx@example.com", "status": "pending"}, {"id": 10, "date": "2025-11-27", "time": "09:30", "client_name": "株式会社YZA", "store_name": "YZA店", "purpose": "定期清掃", "address": "東京都練馬区10-10-10", "phone": "03-0123-4567", "email": "yza@example.com", "status": "pending"}, {"id": 11, "date": "2025-11-27", "time": "14:30", "client_name": "株式会社BCD", "store_name": "BCD店", "purpose": "床清掃", "address": "東京都板橋区11-11-11", "phone": "03-1234-5678", "email": "bcd@example.com", "status": "pending"}, {"id": 12, "date": "2025-11-28", "time": "10:30", "client_name": "株式会社EFG", "store_name": "EFG店", "purpose": "トイレ清掃", "address": "東京都北区12-12-12", "phone": "03-2345-6789", "email": "efg@example.com", "status": "pending"}, {"id": 13, "date": "2025-11-28", "time": "15:30", "client_name": "株式会社HIJ", "store_name": "HIJ店", "purpose": "エアコン清掃", "address": "東京都豊島区13-13-13", "phone": "03-3456-7890", "email": "hij@example.com", "status": "pending"}, {"id": 14, "date": "2025-11-28", "time": "20:00", "client_name": "株式会社KLM", "store_name": "KLM店", "purpose": "定期清掃", "address": "東京都文京区14-14-14", "phone": "03-4567-8901", "email": "klm@example.com", "status": "pending"}]}</script>
  <script type="application/json" id="clients-data">{"clients": [{"company_name": "株式会社 Dart Ace", "company_name_kana": "", "brand_name": "A’s ダーツバー(Darts Bar A's )", "store_name": "日本橋茅場町店", "contact_person": "永井研行", "email": "info@dart-ace.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "2025年3月19日 13:00", "url": "https://x.gd/AkFdE", "cleaning_frequency": "毎月清掃", "id": "2167ccb6"}, {"company_name": "株式会社 Dart Ace", "company_name_kana": "", "brand_name": "A’s ダーツバー(Darts Bar A's )", "store_name": "大塚店", "contact_person": "永井研行", "email": "info@dart-ace.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "2025年3月20日 13:00", "url": "https://x.gd/AkFdE", "cleaning_frequency": "毎月清掃", "id": "bf9f6bcc"}, {"company_name": "株式会社 Dart Ace", "company_name_kana": "", "brand_name": "A’s ダーツバー(Darts Bar A's", "store_name": "高円寺店", "contact_person": "永井研行", "email": "info@dart-ace.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "2025年3月21日 13:00", "url": "https://x.gd/AkFdE", "cleaning_frequency": "毎月清掃", "id": "703bafc0"}, {"company_name": "株式会社 Dart Ace", "company_name_kana": "", "brand_name": "A’s ダーツバー(Darts Bar A's", "store_name": "水道橋店", "contact_person": "永井研行", "email": "info@dart-ace.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "2025年3月11日 7:00", "url": "https://x.gd/AkFdE", "cleaning_frequency": "毎月清掃", "id": "d5da5132"}, {"company_name": "株式会社 Dart Ace", "company_name_kana": "", "brand_name": "A’s ダーツバー(Darts Bar A's", "store_name": "神楽坂店", "contact_person": "永井研行", "email": "info@dart-ace.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "2025年3月11日 13:00", "url": "https://x.gd/AkFdE", "cleaning_frequency": "毎月清掃", "id": "86cce202"}, {"company_name": "株式会社 GRAST", "company_name_kana": "", "brand_name": "手作りの味噌らーめん", "store_name": "味噌樽", "contact_person": "和田 賢次@渡邉社長紹介", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "アプローチ前", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "b94abbdc"}, {"company_name": "株式会社 GRAST", "company_name_kana": "", "brand_name": "北海道らーめん みそ熊", "store_name": "北千住店", "contact_person": "和田 賢次@渡邉社長紹介", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "アプローチ前", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "afeceb88"}, {"company_name": "株式会社 GRAST", "company_name_kana": "", "brand_name": "北海道らーめん みそ熊", "store_name": "王子店", "contact_person": "和田 賢次@渡邉社長紹介", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "アプローチ前", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "a0d05c48"}, {"company_name": "株式会社 SSG", "company_name_kana": "", "brand_name": "上海料理佳樹園", "store_name": "", "contact_person": "砂子田社長", "email": "", "sales_rep": "正田和輝", "store_count": "1店舗", "status": "稼働中", "notes": "4月から月2　グリストラップ清掃＋α", "next_date": "", "url": "", "cleaning_frequency": "２週間に１回", "id": "83816a1c"}, {"company_name": "株式会社 ゴーゴーカレーグループ", "company_name_kana": "", "brand_name": "ゴーゴーカレー", "store_name": "新宿東口駅前スタジアム", "contact_person": "松永", "email": "ksms.matsunaga@gmail.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "33d1da77"}, {"company_name": "株式会社2M8", "company_name_kana": "", "brand_name": "MASSIMOTTVIO", "store_name": "", "contact_person": "角谷店長", "email": "saigonkitchien@dedesuke.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "スポット清掃", "id": "65f8ddef"}, {"company_name": "株式会社Bright", "company_name_kana": "", "brand_name": "貸切居酒屋ラフェス", "store_name": "神田小川町店", "contact_person": "大江　ひとみ", "email": "", "sales_rep": "佐藤大志", "store_count": "", "status": "稼働中", "notes": "3月11日水道蛇口交換工事の依頼。外注合わせて60,000円のニーズがありました。その他に害虫害虫が気になるとのことで今後依頼する可能性あり。売り上げ的には至っていないが、今イベント活動しているため、今後フリーストラップ、床清掃などの提案し依頼される可能性あり", "next_date": "", "url": "", "cleaning_frequency": "", "id": "b5c24939"}, {"company_name": "株式会社CatchBall", "company_name_kana": "", "brand_name": "ラム肉専門店-隣のロッヂ", "store_name": "", "contact_person": "松倉", "email": "t.matsukura@hitsujinolodge.com", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "7/7 　清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "1d895c6c"}, {"company_name": "株式会社CatchBall", "company_name_kana": "", "brand_name": "ようさい", "store_name": "", "contact_person": "松倉", "email": "t.matsukura@hitsujinolodge.com", "sales_rep": "", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "1d895c6c"}, {"company_name": "株式会社FELICE", "company_name_kana": "", "brand_name": "宮崎辛麺　辛麺屋一輪", "store_name": "", "contact_person": "幸谷 仁志", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "スポット依頼", "next_date": "", "url": "", "cleaning_frequency": "", "id": "a91ee1dc"}, {"company_name": "株式会社GOSSO", "company_name_kana": "", "brand_name": "0秒レモンサワー 仙台ホルモン焼肉酒場 ときわ亭", "store_name": "渋谷店", "contact_person": "國吉さん", "email": "kuniyoshi@gosso.co.jp", "sales_rep": "正田和輝", "store_count": "60店舗", "status": "稼働中", "notes": "定期清掃　月75,000円", "next_date": "", "url": "", "cleaning_frequency": "毎月清掃", "id": "1336062b"}, {"company_name": "株式会社GOSSO", "company_name_kana": "", "brand_name": "CRAFTCHEESEMARKET", "store_name": "渋谷店", "contact_person": "高橋", "email": "takahashi_t@gosso.co.jp", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "38a66680"}, {"company_name": "株式会社GRAST", "company_name_kana": "", "brand_name": "北海道らーめん みそ熊", "store_name": "王子店", "contact_person": "桑原政之", "email": "masayuki_kuwabara@mulbelea.co.jp", "sales_rep": "", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "f006e997"}, {"company_name": "株式会社HIRA", "company_name_kana": "", "brand_name": "SUNRIZE", "store_name": "大崎店", "contact_person": "ラミチャネ スリヤ", "email": "suryalami123 @gmail.com", "sales_rep": "正田和輝", "store_count": "", "status": "商談済", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "f61011d7"}, {"company_name": "株式会社INGS", "company_name_kana": "", "brand_name": "CONA 千葉駅前店", "store_name": "", "contact_person": "FC菅又さん", "email": "", "sales_rep": "佐藤大志", "store_count": "", "status": "契約作業中", "notes": "ビーエヌアイ村友さんからのご紹介。千葉の駅前にあるイタリアンのお店クリス。トラップ、ダクト清掃など含めて複数依頼あり。店舗差はこれから実施する。", "next_date": "", "url": "", "cleaning_frequency": "", "id": "059c922e"}, {"company_name": "株式会社Next Culture", "company_name_kana": "", "brand_name": "BAR　FD", "store_name": "", "contact_person": "かおん", "email": "", "sales_rep": "林大貴（浅倉麗央）", "store_count": "", "status": "稼働中", "notes": "ゴミ回収", "next_date": "", "url": "", "cleaning_frequency": "", "id": "9a8c9062"}, {"company_name": "株式会社PET’S MOST", "company_name_kana": "", "brand_name": "inu to hito", "store_name": "", "contact_person": "遠藤", "email": "inutohito0712@gmail.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "d196d7bc"}, {"company_name": "株式会社Plan・Do・See", "company_name_kana": "", "brand_name": "THE MARK GRAND HOTEL", "store_name": "", "contact_person": "関根", "email": "eriko.sekine@themarkgrand.com", "sales_rep": "", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "8481c94b"}, {"company_name": "株式会社wege", "company_name_kana": "", "brand_name": "KUSABIオフィス", "store_name": "", "contact_person": "りょう（永井研行）", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "検討中", "notes": "1年契約が終了するタイミング。", "next_date": "", "url": "", "cleaning_frequency": "", "id": "1df0457b"}, {"company_name": "株式会社ZANGIRI", "company_name_kana": "", "brand_name": "ZANGIRI Next", "store_name": "", "contact_person": "大平社長", "email": "", "sales_rep": "正田和輝", "store_count": "2店舗", "status": "稼働中", "notes": "4月エアコン分解清掃", "next_date": "", "url": "", "cleaning_frequency": "年１清掃", "id": "55d57c2d"}, {"company_name": "株式会社アシュリップ", "company_name_kana": "", "brand_name": "カイロライン", "store_name": "国分寺整体院", "contact_person": "木村さん", "email": "t.kimura@aburagaku.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "f9a6fd67"}, {"company_name": "株式会社いのこ", "company_name_kana": "", "brand_name": "麺処いのこ", "store_name": "赤塚店", "contact_person": "阿部店長", "email": "ossan.t2@ezweb.ne.jp", "sales_rep": "", "store_count": "", "status": "", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "8e67aaa6"}, {"company_name": "株式会社いのこ", "company_name_kana": "", "brand_name": "麺処いのこ", "store_name": "平和台店", "contact_person": "見留太基店長", "email": "gullwing8864@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "75fedfcd"}, {"company_name": "株式会社エゴイプセ", "company_name_kana": "", "brand_name": "大勝軒", "store_name": "大勝軒まるいち 新宿東南口店", "contact_person": "松永誠一", "email": "ksms.matsunaga@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "31aaa93e"}, {"company_name": "株式会社エデュケーション", "company_name_kana": "", "brand_name": "モンキーツリー", "store_name": "", "contact_person": "鈴木社長", "email": "rsa44186@gmail.com", "sales_rep": "正田和輝", "store_count": "1店舗", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "毎月清掃", "id": "dc0c7082"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "魚焼男", "store_name": "弐", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "3ec1b358"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "魚豪商", "store_name": "コダマ新橋店", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "54b66e34"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "魚焼男", "store_name": "新橋本店", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "1e832dc3"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "焼肉男", "store_name": "マンモス", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "ccaeb2ed"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "魚無双", "store_name": "トオダ", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "b1701651"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "魚豪商コダマ", "store_name": "錦糸町店", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "77cd1d5a"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "魚豪商コダマ", "store_name": "大井町店", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "0f8748eb"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "燻男（いぶしお）", "store_name": "", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "78c7baf0"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "ホルモンのマンモス", "store_name": "", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "78c7baf0"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "新魚焼男", "store_name": "ニューサカナヤキオ", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "アプローチ前", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "d3b726d3"}, {"company_name": "株式会社オン・ザ・プラネット", "company_name_kana": "", "brand_name": "新燻男", "store_name": "ニューイブシオ", "contact_person": "玉置竜也", "email": "tamanegi.t@gmail.com  hanakuro13570@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "アプローチ前", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "543c4515"}, {"company_name": "株式会社がっと", "company_name_kana": "", "brand_name": "ワイン食堂がっと", "store_name": "渋谷円山町店", "contact_person": "佐藤 大介", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "2月レンジフードダクト清掃（3万）、5月エアコン分解洗浄、室外機もやりたい", "next_date": "2025年3月19日 7:00", "url": "https://x.gd/IKIiK", "cleaning_frequency": "年１清掃", "id": "0f4557a9"}, {"company_name": "株式会社カワイハイ", "company_name_kana": "", "brand_name": "ニクアザブ", "store_name": "西麻布店", "contact_person": "夕島店長", "email": "", "sales_rep": "正田和輝", "store_count": "7店舗", "status": "稼働中", "notes": "防火扉がしまっていて、左側のキーボックス 0877", "next_date": "", "url": "", "cleaning_frequency": "", "id": "98a40e3b"}, {"company_name": "株式会社ギガデイン", "company_name_kana": "", "brand_name": "武蔵野油学会", "store_name": "早稲田総本店", "contact_person": "木村さん", "email": "t.kimura@aburagaku.com", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "a298df02"}, {"company_name": "株式会社ギガデイン", "company_name_kana": "", "brand_name": "武蔵野油学会", "store_name": "早稲田別館", "contact_person": "木村さん", "email": "t.kimura@aburagaku.com", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "eb276c6d"}, {"company_name": "株式会社ギガデイン", "company_name_kana": "", "brand_name": "武蔵野油学会", "store_name": "明大前", "contact_person": "木村さん", "email": "t.kimura@aburagaku.com", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "60c1653e"}, {"company_name": "株式会社ギガデイン", "company_name_kana": "", "brand_name": "武蔵野油学会", "store_name": "代々木店", "contact_person": "木村さん", "email": "t.kimura@aburagaku.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "81641448"}, {"company_name": "株式会社ギガデイン", "company_name_kana": "", "brand_name": "武蔵野油学会", "store_name": "吉祥寺店", "contact_person": "木村さん", "email": "t.kimura@aburagaku.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "6737de36"}, {"company_name": "株式会社ギガデイン", "company_name_kana": "", "brand_name": "武蔵野油学会", "store_name": "神田店", "contact_person": "木村さん", "email": "t.kimura@aburagaku.com", "sales_rep": "正田和輝", "store_count": "", "status": "検討中", "notes": "フランチャイズでグリストラップとエアコン洗浄を依頼したい", "next_date": "", "url": "", "cleaning_frequency": "", "id": "9f84ba3a"}, {"company_name": "株式会社クラフトマスタージャパン", "company_name_kana": "", "brand_name": "鮨 輝らく", "store_name": "", "contact_person": "堀題地", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "見積書送付", "next_date": "", "url": "", "cleaning_frequency": "", "id": "9c10049e"}, {"company_name": "株式会社しゃぶ庵", "company_name_kana": "", "brand_name": "一見さんお断り 完全会員制 お座敷遊び 料亭 「独楽」", "store_name": "", "contact_person": "福田誠治", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "西麻布のBAR、金龍、独楽をやっている。", "next_date": "", "url": "https://x.gd/zwmhm", "cleaning_frequency": "", "id": "c25dbcb3"}, {"company_name": "株式会社ストラク", "company_name_kana": "", "brand_name": "焼肉商店 浦島屋 津田沼店", "store_name": "", "contact_person": "FC菅又さん", "email": "m-sugamata@springs-web.com", "sales_rep": "佐藤大志", "store_count": "", "status": "契約作業中", "notes": "ビーエヌI村友さんからのご紹介。津田沼駅にある焼肉店のご依頼ホール内に複数の天井から通されている。ダクトあり。その他油まみれな部分があるため清掃依頼あり", "next_date": "", "url": "", "cleaning_frequency": "", "id": "7831fc54"}, {"company_name": "株式会社スモールズ", "company_name_kana": "", "brand_name": "オイスター&珍味 bar 不夜城", "store_name": "", "contact_person": "長田　光司", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "bc5c5b70"}, {"company_name": "株式会社スモールズ", "company_name_kana": "", "brand_name": "ディストピアBar KARMA　カルマ", "store_name": "", "contact_person": "長田　光司", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "bc5c5b70"}, {"company_name": "株式会社スモールズ", "company_name_kana": "", "brand_name": "Japanese Bar　猪鹿蝶", "store_name": "", "contact_person": "長田　光司", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "bc5c5b70"}, {"company_name": "株式会社スモールズ", "company_name_kana": "", "brand_name": "Bar ANIME HOLIC アニメホリック goldengai", "store_name": "", "contact_person": "長田　光司", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "bc5c5b70"}, {"company_name": "株式会社スモールズ", "company_name_kana": "", "brand_name": "Bar 灯鏡 tokyo 歌舞伎町レッドのれん街", "store_name": "", "contact_person": "長田　光司", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "bc5c5b70"}, {"company_name": "株式会社ダイニングエッジ", "company_name_kana": "", "brand_name": "楽が気", "store_name": "新橋本店", "contact_person": "黒沢 幸樹", "email": "koki-kurosawa@diningedge.co.jp", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "26bf2a5d"}, {"company_name": "株式会社ダイニング富士屋本店", "company_name_kana": "", "brand_name": "富士屋本店", "store_name": "日本橋浜町", "contact_person": "加藤雄三", "email": "", "sales_rep": "", "store_count": "", "status": "", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "94f76013"}, {"company_name": "株式会社ダイニング富士屋本店", "company_name_kana": "", "brand_name": "立呑 富士屋本店", "store_name": "立呑 富士屋本店", "contact_person": "酒主", "email": "", "sales_rep": "", "store_count": "", "status": "", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "c7fe22ba"}, {"company_name": "株式会社ダイニング富士屋本店", "company_name_kana": "", "brand_name": "富士屋本店", "store_name": "日本橋浜町", "contact_person": "", "email": "", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "24305c2b"}, {"company_name": "株式会社テイクユー", "company_name_kana": "", "brand_name": "貝出汁 中華そば 竹祥", "store_name": "", "contact_person": "中村", "email": "yuichi@muse-sava.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "707918f1"}, {"company_name": "株式会社デイジイ", "company_name_kana": "", "brand_name": "株式会社デイジイ", "store_name": "西新宿店", "contact_person": "倉田尚子常務取締役", "email": "", "sales_rep": "", "store_count": "", "status": "", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "266fe182"}, {"company_name": "株式会社デイジイ", "company_name_kana": "", "brand_name": "株式会社デイジイ", "store_name": "麹町店", "contact_person": "倉田尚子常務取締役", "email": "", "sales_rep": "", "store_count": "", "status": "", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "50509a58"}, {"company_name": "株式会社でですけ", "company_name_kana": "", "brand_name": "でですけサイゴンキッチン", "store_name": "", "contact_person": "小原店長", "email": "", "sales_rep": "正田和輝", "store_count": "8店舗", "status": "稼働中", "notes": "エアコン清掃依頼　遠藤さんが獲得、営業案件", "next_date": "", "url": "", "cleaning_frequency": "スポット清掃", "id": "cc9d3593"}, {"company_name": "株式会社ニュートン", "company_name_kana": "", "brand_name": "カラオケパセラ", "store_name": "上野駅前店", "contact_person": "根本 諭", "email": "hiraoka@newton-co.jp", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "6ff89ce9"}, {"company_name": "株式会社ニュートン", "company_name_kana": "", "brand_name": "カラオケパセラ", "store_name": "上野御徒町店", "contact_person": "根本 諭", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "アプローチ前", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "5029e8c1"}, {"company_name": "株式会社パズルフードサービス", "company_name_kana": "", "brand_name": "東京餃子楼", "store_name": "三軒茶屋本店", "contact_person": "齋藤部長　奥村啓社長", "email": "food@puzzle-ring.co.jp", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "スポット清掃", "id": "7d9b5321"}, {"company_name": "株式会社パズルフードサービス", "company_name_kana": "", "brand_name": "東京餃子楼", "store_name": "工場", "contact_person": "齋藤部長　奥村啓社長", "email": "food@puzzle-ring.co.jp", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "隔月清掃", "id": "4ed53c81"}, {"company_name": "株式会社ビック・バン", "company_name_kana": "", "brand_name": "ホルモン屋 だん", "store_name": "新橋総本店", "contact_person": "三浦さん（渡辺社長）", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "ネズミ駆除の定期清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "b88fd428"}, {"company_name": "株式会社ビック・バン", "company_name_kana": "", "brand_name": "ホルモン屋 だん", "store_name": "新橋2号店", "contact_person": "渡辺社長", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "ネズミ駆除の定期清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "2e3fe061"}, {"company_name": "株式会社ビック・バン", "company_name_kana": "", "brand_name": "ホルモン屋 だん", "store_name": "はなれ新橋3号店", "contact_person": "渡辺社長", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "ネズミ駆除の定期清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "33e6a3c3"}, {"company_name": "株式会社ビック・バン", "company_name_kana": "", "brand_name": "生ラムかんな", "store_name": "新橋店", "contact_person": "渡辺社長", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "ネズミ駆除の定期清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "325a8b56"}, {"company_name": "株式会社ビック・バン", "company_name_kana": "", "brand_name": "ラムと泡", "store_name": "本店", "contact_person": "渡辺社長", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "ネズミ駆除の定期清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "15bc6988"}, {"company_name": "株式会社ビック・バン", "company_name_kana": "", "brand_name": "肉汁屋", "store_name": "新橋店", "contact_person": "渡辺社長", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "ネズミ駆除の定期清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "325a8b56"}, {"company_name": "株式会社フードアンドパートナーズ", "company_name_kana": "", "brand_name": "発酵デリカテッセンカフェテリアKouji&ko", "store_name": "", "contact_person": "高野伴美（高橋真樹）", "email": "takahashi-maki@foodandpartners.co.jp", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "渋谷と新宿のテナントに入居中", "next_date": "", "url": "https://x.gd/c4Ern", "cleaning_frequency": "3ヶ月に1回清掃", "id": "0ad5d6bf"}, {"company_name": "株式会社フードアンドパートナーズ", "company_name_kana": "", "brand_name": "発酵デリカテッセン カフェテリアKouji&ko", "store_name": "", "contact_person": "高橋部長", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "３ヶ月に1回清掃", "next_date": "", "url": "", "cleaning_frequency": "", "id": "78449035"}, {"company_name": "株式会社マッスルボディメイク", "company_name_kana": "", "brand_name": "マッスルボディメイク", "store_name": "", "contact_person": "吉成題寿", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "パーソナルジム", "next_date": "", "url": "https://x.gd/4O2gk", "cleaning_frequency": "スポット清掃", "id": "ddbce584"}, {"company_name": "株式会社まんてん", "company_name_kana": "", "brand_name": "炉端居酒屋", "store_name": "中野製作所 まんてん別館", "contact_person": "真船店長（阿部社長）", "email": "", "sales_rep": "正田和輝", "store_count": "7店舗", "status": "稼働中", "notes": "ゴキブリ駆除依頼", "next_date": "2025年3月21日 13:00", "url": "", "cleaning_frequency": "スポット清掃", "id": "4328c02c"}, {"company_name": "株式会社まんてん", "company_name_kana": "", "brand_name": "炭火焼きホルモンまんてん", "store_name": "中野店", "contact_person": "村上店長（阿部社長）", "email": "", "sales_rep": "正田和輝", "store_count": "7店舗", "status": "稼働中", "notes": "・ゴキブリ", "next_date": "", "url": "", "cleaning_frequency": "", "id": "9afccec8"}, {"company_name": "株式会社まんてん", "company_name_kana": "", "brand_name": "炭火焼きホルモンまんてん", "store_name": "中目黒本店", "contact_person": "はづき", "email": "", "sales_rep": "正田和輝", "store_count": "7店舗", "status": "稼働中", "notes": "古い店なのでそこそこ汚れはあるんですが、子バエがいるのが気になりますね", "next_date": "2025年3月28日 10:30", "url": "", "cleaning_frequency": "毎月清掃", "id": "254bf36f"}, {"company_name": "株式会社まんてん", "company_name_kana": "", "brand_name": "炭火焼きホルモンまんてん", "store_name": "代々木店", "contact_person": "神棒智", "email": "", "sales_rep": "正田和輝", "store_count": "7店舗", "status": "稼働中", "notes": "ダクト清掃", "next_date": "2025年3月28日 10:30", "url": "", "cleaning_frequency": "毎月清掃", "id": "27cff7c3"}, {"company_name": "株式会社ラムラ", "company_name_kana": "", "brand_name": "すし土風炉", "store_name": "登戸店", "contact_person": "", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "0a3b06ee"}, {"company_name": "株式会社価値作り研究所", "company_name_kana": "", "brand_name": "ステーキロッジ", "store_name": "道元坂店", "contact_person": "福田幸洋", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "https://x.gd/Ntu4u", "cleaning_frequency": "", "id": "703690b5"}, {"company_name": "株式会社価値作り研究所", "company_name_kana": "", "brand_name": "ステーキロッヂ ヨドバシ", "store_name": "Akiba店", "contact_person": "福田幸洋", "email": "", "sales_rep": "正田和輝", "store_count": "数店舗", "status": "契約作業中", "notes": "", "next_date": "", "url": "https://x.gd/7g4sW", "cleaning_frequency": "", "id": "c22b7491"}, {"company_name": "株式会社元気Dining", "company_name_kana": "", "brand_name": "大衆寿司酒場こがね", "store_name": "", "contact_person": "永井部長", "email": "", "sales_rep": "", "store_count": "", "status": "", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "f540557f"}, {"company_name": "株式会社元気Dining", "company_name_kana": "", "brand_name": "大衆焼肉酒場こがね", "store_name": "", "contact_person": "永井部長", "email": "nagai.r.genki@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "f540557f"}, {"company_name": "株式会社小肥羊ジャパン", "company_name_kana": "", "brand_name": "火鍋 小肥羊", "store_name": "銀座店", "contact_person": "梶原部長", "email": "", "sales_rep": "正田和輝", "store_count": "20店舗", "status": "稼働中", "notes": "ネズミ駆除、6月〜7月、撲滅してから考える。", "next_date": "", "url": "", "cleaning_frequency": "毎月清掃", "id": "868b43b1"}, {"company_name": "株式会社千寿菊", "company_name_kana": "", "brand_name": "新橋バーラウンジ御殿", "store_name": "", "contact_person": "鈴木真理子", "email": "", "sales_rep": "林大貴（浅倉麗央）", "store_count": "", "status": "稼働中", "notes": "グリストラップ エアコンフィルター 厨房フィルター 害虫駆除 厨房機器掻き出し シンクの臭い除去 シンク清掃 初回50,000円", "next_date": "", "url": "", "cleaning_frequency": "", "id": "d5d6c028"}, {"company_name": "株式会社馬力　神田店", "company_name_kana": "", "brand_name": "馬力", "store_name": "馬力 神田南口店", "contact_person": "渡邉", "email": "bariki.group@ezweb.ne.jp", "sales_rep": "沖 智弘", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "4a310e3d"}, {"company_name": "株式会社名店館", "company_name_kana": "", "brand_name": "ビストロ エヴォルテ", "store_name": "", "contact_person": "木ノ内 謙", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "https://x.gd/nUWrX", "cleaning_frequency": "3ヶ月に1回清掃", "id": "7f2539db"}, {"company_name": "株式会社友電設", "company_name_kana": "", "brand_name": "Mahaloh Import Shop", "store_name": "", "contact_person": "ウィリアン", "email": "Willianmahalohjp@hotmail.com", "sales_rep": "梅岡Alexandra", "store_count": "1", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "373e4c83"}, {"company_name": "株式会社雷神", "company_name_kana": "", "brand_name": "油そば 雷神", "store_name": "市川店", "contact_person": "加藤陸王　（加藤 裕之）", "email": "goku.kato@raijin-gyouza.jp", "sales_rep": "正田和輝", "store_count": "1店舗", "status": "契約作業中", "notes": "柏　6月1日から開始", "next_date": "", "url": "", "cleaning_frequency": "", "id": "1afaa333"}, {"company_name": "居酒屋ビッグ 新河岸駅前店", "company_name_kana": "", "brand_name": "居酒屋ビッグ", "store_name": "新河岸駅前店", "contact_person": "神宮　将", "email": "js.bar.54fg@gmail.com", "sales_rep": "", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "668ca5b2"}, {"company_name": "御座敷天婦羅　神楽坂 天孝", "company_name_kana": "", "brand_name": "御座敷天婦羅　神楽坂 天孝", "store_name": "", "contact_person": "新井　均", "email": "h.arai@kagurasaka-tenko.jp", "sales_rep": "遠藤虹輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "スポット清掃", "id": "afb44227"}, {"company_name": "合同会社FOOD GROOVE JAPAN", "company_name_kana": "", "brand_name": "米と魚　さかなさま", "store_name": "", "contact_person": "酒井（鈴木基次）", "email": "info.foodgroovejapan@gmail.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "末日ゴミ回収＋見積もりの内容", "next_date": "2025年3月28日 0:00", "url": "https://x.gd/UneyL", "cleaning_frequency": "", "id": "ff399963"}, {"company_name": "合同会社FOOD GROOVE JAPAN", "company_name_kana": "", "brand_name": "麺と肴　担々麺 ペン坊", "store_name": "", "contact_person": "青柳昇店長(さかなさまスタッフ)", "email": "noboru.ao@gmail.com", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "レンジフードのグリスフィルターがない。", "next_date": "", "url": "", "cleaning_frequency": "", "id": "d4cf599b"}, {"company_name": "合同会社SKTC", "company_name_kana": "", "brand_name": "Aphrodite　アフロディーテ（ニューハーフバー）", "store_name": "", "contact_person": "岩下 弥樹", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "3月清掃", "next_date": "", "url": "https://x.gd/LdNvl", "cleaning_frequency": "スポット清掃", "id": "e2508de7"}, {"company_name": "合同会社TRANSAM", "company_name_kana": "", "brand_name": "dining Bar TRANSAM赤坂", "store_name": "", "contact_person": "宮西宏嘉", "email": "", "sales_rep": "佐藤大志", "store_count": "1", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "930ccaef"}, {"company_name": "合同会社港エージェンシー", "company_name_kana": "", "brand_name": "西麻布ZERO", "store_name": "", "contact_person": "福田誠治", "email": "", "sales_rep": "正田和輝", "store_count": "2,3,4階", "status": "契約作業中", "notes": "定期清掃 10万（床/ソファ/カーペット/エアコンフィルター）", "next_date": "", "url": "", "cleaning_frequency": "", "id": "82e64aee"}, {"company_name": "合同会社港エージェンシー", "company_name_kana": "", "brand_name": "西麻布カラオケCLT", "store_name": "", "contact_person": "福田誠治", "email": "", "sales_rep": "正田和輝", "store_count": "6階１店舗", "status": "契約作業中", "notes": "6階 5万", "next_date": "", "url": "", "cleaning_frequency": "", "id": "82e64aee"}, {"company_name": "焼肉 松の屋", "company_name_kana": "", "brand_name": "焼肉 松の屋", "store_name": "焼肉 松の屋", "contact_person": "岩渕", "email": "t.iwabuchi-74@sp-nur.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "7fdb0819"}, {"company_name": "板前寿司ジャパン", "company_name_kana": "", "brand_name": "板前寿司", "store_name": "赤坂店", "contact_person": "月木専務", "email": "tsukigi@itamae.co.jp", "sales_rep": "正田和輝", "store_count": "8店舗", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "f26f4f31"}, {"company_name": "板前寿司ジャパン", "company_name_kana": "", "brand_name": "板前寿司", "store_name": "愛宕店", "contact_person": "月木専務", "email": "tsukigi@itamae.co.jp", "sales_rep": "正田和輝", "store_count": "8店舗", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "4868fa83"}, {"company_name": "有限会社タカネット", "company_name_kana": "", "brand_name": "ロケ弁エージェント", "store_name": "", "contact_person": "高杉光徳", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "ロケ弁の店舗三ノ輪で４店舗ある。", "next_date": "", "url": "", "cleaning_frequency": "", "id": "990a563e"}, {"company_name": "", "company_name_kana": "", "brand_name": "たまき新宿2代目店", "store_name": "たまき新宿2代目店", "contact_person": "グルン", "email": "gbu4991@gmail.com", "sales_rep": "沖 智弘", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "ada1ef3f"}, {"company_name": "", "company_name_kana": "", "brand_name": "韓国料理COCOYA", "store_name": "池袋2号店", "contact_person": "", "email": "", "sales_rep": "", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "58ca79e3"}, {"company_name": "", "company_name_kana": "", "brand_name": "創作イタリアン肉バル スオーノ", "store_name": "", "contact_person": "能勢 純司", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "グリースサットルで床も荒れ放題", "next_date": "", "url": "", "cleaning_frequency": "", "id": "bc2ac60e"}, {"company_name": "", "company_name_kana": "", "brand_name": "リストランティアーノ　　ルベロ", "store_name": "", "contact_person": "長澤流（竹中社長）", "email": "", "sales_rep": "正田和輝", "store_count": "1", "status": "契約作業中", "notes": "", "next_date": "", "url": "https://x.gd/nCFom", "cleaning_frequency": "", "id": "6c3b4e4b"}, {"company_name": "", "company_name_kana": "", "brand_name": "CRAFT CHEESE MARKET", "store_name": "渋谷駅前店", "contact_person": "", "email": "", "sales_rep": "", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "3314df61"}, {"company_name": "", "company_name_kana": "", "brand_name": "デニーロ", "store_name": "デニーロ神田店", "contact_person": "今村店長", "email": "shinpei9600@gmail.com", "sales_rep": "正田和輝", "store_count": "2店舗", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "毎月清掃", "id": "a71e8c2c"}, {"company_name": "", "company_name_kana": "", "brand_name": "FAST OYSTERS", "store_name": "神楽坂店", "contact_person": "渡邉社長", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "950883e3"}, {"company_name": "", "company_name_kana": "", "brand_name": "WAGYU SUKIYAKI 極〜GOKU〜", "store_name": "東銀座築地", "contact_person": "浦 昴大", "email": "", "sales_rep": "正田和輝", "store_count": "", "status": "契約作業中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "b5c0e18c"}, {"company_name": "", "company_name_kana": "", "brand_name": "家庭料理居酒屋　焼肉Yakitaro", "store_name": "水道橋店", "contact_person": "秋元賢", "email": "yakitaro5215@ezweb.ne.jp", "sales_rep": "正田和輝", "store_count": "", "status": "稼働中", "notes": "", "next_date": "", "url": "", "cleaning_frequency": "", "id": "36010174"}], "total": 114}</script>
  
  <script>
    (function() {
      // Load data
      const scheduleData = JSON.parse(document.getElementById('schedule-data').textContent);
      const clientsData = JSON.parse(document.getElementById('clients-data').textContent);
      
      // Store schedules in memory
      let schedules = scheduleData.schedules || [];
      
      // Calendar state
      let currentDate = new Date();
      let currentView = 'month';
      let selectedDate = null;
      
      // Calendar types
      const calendarTypes = [
        { id: '見積もり提出', name: '見積もり提出', color: '#4285f4', visible: true },
        { id: '商談', name: '商談', color: '#fbbc04', visible: true },
        { id: '定期訪問', name: '定期訪問', color: '#34a853', visible: true },
        { id: '清掃状況確認', name: '清掃状況確認', color: '#ea4335', visible: true },
        { id: 'その他', name: 'その他', color: '#9aa0a6', visible: true }
      ];
      
      // Drag & Drop state
      let dragState = {
        isDragging: false,
        isResizing: false,
        scheduleId: null,
        scheduleElement: null,
        startX: 0,
        startY: 0,
        startDate: null,
        startTime: null,
        resizeType: null
      };
      
      // Initialize
      init();
      
      function init() {
        // Render calendar list
        renderCalendarList();
        
        // View tabs
        document.querySelectorAll('.view-tab-sidebar').forEach(tab => {
          tab.addEventListener('click', () => {
            switchView(tab.dataset.view);
          });
        });
        
        // Navigation
        document.getElementById('prev-btn').addEventListener('click', () => navigate(-1));
        document.getElementById('next-btn').addEventListener('click', () => navigate(1));
        document.getElementById('today-btn').addEventListener('click', () => {
          currentDate = new Date();
          renderCurrentView();
        });
        
        // Menu toggle
        document.getElementById('menu-toggle').addEventListener('click', () => {
          document.querySelector('.calendar-sidebar').classList.toggle('open');
        });
        
        // Create button
        document.querySelector('.create-btn').addEventListener('click', () => {
          openScheduleModal();
        });
        
        // Modal
        document.getElementById('modal-close').addEventListener('click', closeScheduleModal);
        document.getElementById('modal-cancel').addEventListener('click', closeScheduleModal);
        document.getElementById('schedule-form').addEventListener('submit', handleScheduleSubmit);
        document.getElementById('modal-delete').addEventListener('click', handleScheduleDelete);
        
        // Populate client select
        populateClientSelect();
        
        // Initial render
        renderCurrentView();
      }
      
      function renderCalendarList() {
        const container = document.getElementById('calendar-list-items');
        container.innerHTML = '';
        
        calendarTypes.forEach(type => {
          const item = document.createElement('div');
          item.className = `calendar-item ${type.visible ? '' : 'hidden'}`;
          item.innerHTML = `
            <div class="calendar-color purpose-${type.id}" style="background: ${type.color}"></div>
            <span class="calendar-name">${type.name}</span>
            <div class="calendar-toggle"></div>
          `;
          item.addEventListener('click', (e) => {
            if (e.target.classList.contains('calendar-toggle') || e.target.closest('.calendar-toggle')) {
              type.visible = !type.visible;
              item.classList.toggle('hidden');
              renderCurrentView();
            }
          });
          container.appendChild(item);
        });
      }
      
      function switchView(view) {
        currentView = view;
        document.querySelectorAll('.view-tab-sidebar').forEach(tab => {
          tab.classList.toggle('active', tab.dataset.view === view);
        });
        document.querySelectorAll('.calendar-view').forEach(v => {
          v.classList.add('hidden');
        });
        document.getElementById(`${view}-view`).classList.remove('hidden');
        renderCurrentView();
      }
      
      function navigate(direction) {
        if (currentView === 'month') {
          currentDate.setMonth(currentDate.getMonth() + direction);
        } else if (currentView === 'week') {
          currentDate.setDate(currentDate.getDate() + (direction * 7));
        } else if (currentView === 'day') {
          currentDate.setDate(currentDate.getDate() + direction);
        }
        renderCurrentView();
      }
      
      function renderCurrentView() {
        if (currentView === 'month') {
          renderMonthView();
        } else if (currentView === 'week') {
          renderWeekView();
        } else if (currentView === 'day') {
          renderDayView();
        }
        updateDateTitle();
      }
      
      function updateDateTitle() {
        const titleEl = document.getElementById('current-date-title');
        const year = currentDate.getFullYear();
        const month = currentDate.getMonth() + 1;
        const day = currentDate.getDate();
        
        if (currentView === 'month') {
          titleEl.textContent = `${year}年${month}月`;
        } else if (currentView === 'week') {
          const startOfWeek = getStartOfWeek(currentDate);
          const endOfWeek = new Date(startOfWeek);
          endOfWeek.setDate(endOfWeek.getDate() + 6);
          titleEl.textContent = `${formatDateDisplay(startOfWeek)} - ${formatDateDisplay(endOfWeek)}`;
        } else if (currentView === 'day') {
          titleEl.textContent = `${year}年${month}月${day}日`;
        }
      }
      
      function renderMonthView() {
        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();
        const monthNames = ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'];
        
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const daysInMonth = lastDay.getDate();
        const startingDayOfWeek = firstDay.getDay();
        
        const container = document.getElementById('calendar-days-month');
        container.innerHTML = '';
        
        // Previous month days
        const prevMonthLastDay = new Date(year, month, 0).getDate();
        for (let i = startingDayOfWeek - 1; i >= 0; i--) {
          const dayNum = prevMonthLastDay - i;
          const prevMonth = month === 0 ? 11 : month - 1;
          const prevYear = month === 0 ? year - 1 : year;
          const dateStr = `${prevYear}-${String(prevMonth + 1).padStart(2, '0')}-${String(dayNum).padStart(2, '0')}`;
          container.appendChild(createDayElement(dayNum, true, dateStr));
        }
        
        // Current month days
        const today = new Date();
        for (let i = 1; i <= daysInMonth; i++) {
          const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
          const dayEl = createDayElement(i, false, dateStr);
          if (year === today.getFullYear() && month === today.getMonth() && i === today.getDate()) {
            dayEl.classList.add('today');
          }
          container.appendChild(dayEl);
        }
        
        // Next month days
        const remainingDays = 42 - (startingDayOfWeek + daysInMonth);
        for (let i = 1; i <= remainingDays; i++) {
          const nextMonth = month === 11 ? 0 : month + 1;
          const nextYear = month === 11 ? year + 1 : year;
          const dateStr = `${nextYear}-${String(nextMonth + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
          container.appendChild(createDayElement(i, true, dateStr));
        }
      }
      
      function createDayElement(dayNumber, isOtherMonth, dateStr) {
        const day = document.createElement('div');
        day.className = 'calendar-day-month';
        if (isOtherMonth) {
          day.classList.add('other-month');
        }
        day.dataset.date = dateStr;
        
        const dayNumberEl = document.createElement('div');
        dayNumberEl.className = 'day-number';
        dayNumberEl.textContent = dayNumber;
        day.appendChild(dayNumberEl);
        
        // Get visible schedules for this day
        const daySchedules = schedules.filter(s => {
          if (s.date !== dateStr || s.status === 'completed') return false;
          const calendarType = calendarTypes.find(t => t.id === s.purpose);
          return calendarType && calendarType.visible;
        });
        
        if (daySchedules.length > 0) {
          daySchedules.sort((a, b) => a.time.localeCompare(b.time));
          const eventsDiv = document.createElement('div');
          eventsDiv.className = 'day-events';
          
          const maxVisible = 3;
          daySchedules.slice(0, maxVisible).forEach(schedule => {
            const eventEl = document.createElement('div');
            eventEl.className = `day-event purpose-${schedule.purpose}`;
            eventEl.textContent = `${schedule.time} ${schedule.client_name || schedule.purpose}`;
            eventEl.addEventListener('click', (e) => {
              e.stopPropagation();
              openScheduleModal(null, schedule.id);
            });
            eventsDiv.appendChild(eventEl);
          });
          
          if (daySchedules.length > maxVisible) {
            const moreEl = document.createElement('div');
            moreEl.className = 'day-event-more';
            moreEl.textContent = `+${daySchedules.length - maxVisible}件`;
            eventsDiv.appendChild(moreEl);
          }
          
          day.appendChild(eventsDiv);
        }
        
        day.addEventListener('click', (e) => {
          if (!e.target.closest('.day-event')) {
            openScheduleModal(dateStr);
          }
        });
        
        return day;
      }
      
      function renderWeekView() {
        const startOfWeek = getStartOfWeek(currentDate);
        const today = new Date();
        
        // Render time slots
        const timeSlots = document.getElementById('time-slots-week');
        timeSlots.innerHTML = '';
        for (let hour = 0; hour < 24; hour++) {
          const slot = document.createElement('div');
          slot.className = 'time-slot';
          slot.textContent = `${String(hour).padStart(2, '0')}:00`;
          timeSlots.appendChild(slot);
        }
        
        // Render day headers
        const daysHeader = document.getElementById('days-header-week');
        daysHeader.innerHTML = '';
        const dayNames = ['日', '月', '火', '水', '木', '金', '土'];
        for (let i = 0; i < 7; i++) {
          const day = new Date(startOfWeek);
          day.setDate(startOfWeek.getDate() + i);
          const dateStr = formatDate(day);
          const header = document.createElement('div');
          header.className = 'day-header';
          if (formatDate(day) === formatDate(today)) {
            header.classList.add('today');
          }
          header.innerHTML = `
            <div class="day-header-name">${dayNames[i]}</div>
            <div class="day-header-number">${day.getDate()}</div>
          `;
          daysHeader.appendChild(header);
        }
        
        // Render day columns
        const daysContent = document.getElementById('days-content-week');
        daysContent.innerHTML = '';
        for (let i = 0; i < 7; i++) {
          const day = new Date(startOfWeek);
          day.setDate(startOfWeek.getDate() + i);
          const dateStr = formatDate(day);
          
          const dayColumn = document.createElement('div');
          dayColumn.className = 'day-column-week';
          
          for (let hour = 0; hour < 24; hour++) {
            const timeSlot = document.createElement('div');
            timeSlot.className = 'day-time-slot';
            timeSlot.dataset.date = dateStr;
            timeSlot.dataset.hour = hour;
            
            // Find schedules for this day and hour
            const hourSchedules = schedules.filter(s => {
              if (s.date !== dateStr || s.status === 'completed') return false;
              const scheduleHour = parseInt(s.time.split(':')[0]);
              if (scheduleHour !== hour) return false;
              const calendarType = calendarTypes.find(t => t.id === s.purpose);
              return calendarType && calendarType.visible;
            });
            
            hourSchedules.forEach(schedule => {
              const eventEl = createWeekEvent(schedule, dateStr, hour);
              timeSlot.appendChild(eventEl);
            });
            
            timeSlot.addEventListener('click', (e) => {
              if (!e.target.closest('.week-event')) {
                const defaultTime = `${String(hour).padStart(2, '0')}:00`;
                openScheduleModal(dateStr, null, defaultTime);
              }
            });
            
            dayColumn.appendChild(timeSlot);
          }
          
          daysContent.appendChild(dayColumn);
        }
      }
      
      function createWeekEvent(schedule, dateStr, hour) {
        const eventEl = document.createElement('div');
        eventEl.className = `week-event purpose-${schedule.purpose}`;
        eventEl.dataset.scheduleId = schedule.id;
        const [scheduleHour, scheduleMinute] = schedule.time.split(':').map(Number);
        const topPercent = (scheduleMinute / 60) * 100;
        eventEl.style.top = `${topPercent}%`;
        eventEl.innerHTML = `
          <div style="font-weight: 600; margin-bottom: 2px;">${schedule.time}</div>
          <div style="font-size: 0.7rem; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${schedule.client_name || schedule.purpose}</div>
          <div class="resize-handle resize-handle-top"></div>
          <div class="resize-handle"></div>
        `;
        
        eventEl.addEventListener('click', (e) => {
          if (!dragState.isDragging && !dragState.isResizing) {
            e.stopPropagation();
            openScheduleModal(null, schedule.id);
          }
        });
        
        // Setup drag handlers
        setupDragHandlers(eventEl, schedule, 'week');
        
        return eventEl;
      }
      
      function renderDayView() {
        const dateStr = formatDate(currentDate);
        const today = new Date();
        
        // Render time slots
        const timeSlots = document.getElementById('time-slots-day');
        timeSlots.innerHTML = '';
        for (let hour = 0; hour < 24; hour++) {
          const slot = document.createElement('div');
          slot.className = 'time-slot';
          slot.textContent = `${String(hour).padStart(2, '0')}:00`;
          timeSlots.appendChild(slot);
        }
        
        // Render day header
        const dayHeader = document.getElementById('day-header-day');
        const dayNames = ['日', '月', '火', '水', '木', '金', '土'];
        const dayName = dayNames[currentDate.getDay()];
        dayHeader.innerHTML = `
          <div class="day-header-name">${dayName}</div>
          <div class="day-header-number">${currentDate.getDate()}</div>
        `;
        if (formatDate(currentDate) === formatDate(today)) {
          dayHeader.classList.add('today');
        }
        
        // Render day content
        const dayContent = document.getElementById('day-content-day');
        dayContent.innerHTML = '';
        
        const daySchedules = schedules.filter(s => {
          if (s.date !== dateStr || s.status === 'completed') return false;
          const calendarType = calendarTypes.find(t => t.id === s.purpose);
          return calendarType && calendarType.visible;
        });
        daySchedules.sort((a, b) => a.time.localeCompare(b.time));
        
        for (let hour = 0; hour < 24; hour++) {
          const timeSlot = document.createElement('div');
          timeSlot.className = 'day-time-slot';
          timeSlot.dataset.hour = hour;
          
          const hourSchedules = daySchedules.filter(s => {
            const scheduleHour = parseInt(s.time.split(':')[0]);
            return scheduleHour === hour;
          });
          
          if (hourSchedules.length > 0) {
            hourSchedules.forEach(schedule => {
              const eventEl = createDayEvent(schedule);
              timeSlot.appendChild(eventEl);
            });
          } else {
            timeSlot.addEventListener('click', () => {
              const defaultTime = `${String(hour).padStart(2, '0')}:00`;
              openScheduleModal(dateStr, null, defaultTime);
            });
          }
          
          dayContent.appendChild(timeSlot);
        }
      }
      
      function createDayEvent(schedule) {
        const eventEl = document.createElement('div');
        eventEl.className = `day-event purpose-${schedule.purpose}`;
        eventEl.dataset.scheduleId = schedule.id;
        eventEl.innerHTML = `
          <div class="day-schedule-time">${schedule.time}</div>
          <div class="day-schedule-title">${schedule.client_name}</div>
          ${schedule.store_name ? `<div class="day-schedule-details">${schedule.store_name}</div>` : ''}
          <div class="day-schedule-details">${schedule.purpose}</div>
        `;
        
        eventEl.addEventListener('click', (e) => {
          if (!dragState.isDragging) {
            e.stopPropagation();
            openScheduleModal(null, schedule.id);
          }
        });
        
        // Setup drag handlers
        setupDragHandlers(eventEl, schedule, 'day');
        
        return eventEl;
      }
      
      function setupDragHandlers(element, schedule, view) {
        // Drag start
        element.addEventListener('mousedown', (e) => {
          if (e.target.classList.contains('resize-handle')) {
            dragState.isResizing = true;
            dragState.resizeType = e.target.classList.contains('resize-handle-top') ? 'top' : 'bottom';
          } else {
            dragState.isDragging = true;
          }
          dragState.scheduleId = schedule.id;
          dragState.scheduleElement = element;
          dragState.startX = e.clientX;
          dragState.startY = e.clientY;
          dragState.startDate = schedule.date;
          dragState.startTime = schedule.time;
          element.classList.add('dragging');
          e.preventDefault();
        });
        
        // Drag move
        document.addEventListener('mousemove', (e) => {
          if (!dragState.isDragging && !dragState.isResizing) return;
          e.preventDefault();
          // Drag implementation would go here
        });
        
        // Drag end
        document.addEventListener('mouseup', () => {
          if (dragState.isDragging || dragState.isResizing) {
            dragState.isDragging = false;
            dragState.isResizing = false;
            if (dragState.scheduleElement) {
              dragState.scheduleElement.classList.remove('dragging');
            }
            dragState.scheduleElement = null;
          }
        });
      }
      
      function openScheduleModal(dateStr = null, scheduleId = null, defaultTime = null) {
        const modal = document.getElementById('schedule-modal');
        const form = document.getElementById('schedule-form');
        const modalTitle = document.getElementById('modal-title');
        const deleteBtn = document.getElementById('modal-delete');
        
        form.reset();
        document.getElementById('schedule-id').value = '';
        
        if (scheduleId) {
          const schedule = schedules.find(s => s.id === scheduleId);
          if (schedule) {
            modalTitle.textContent = 'スケジュールを編集';
            deleteBtn.classList.remove('hidden');
            document.getElementById('schedule-id').value = schedule.id;
            document.getElementById('schedule-title').value = schedule.client_name || '';
            document.getElementById('schedule-date').value = schedule.date;
            const [startHour, startMin] = schedule.time.split(':');
            document.getElementById('schedule-time-start').value = `${startHour}:${startMin}`;
            // Assume 1 hour duration
            const endTime = new Date(`2000-01-01T${startHour}:${startMin}`);
            endTime.setHours(endTime.getHours() + 1);
            document.getElementById('schedule-time-end').value = `${String(endTime.getHours()).padStart(2, '0')}:${String(endTime.getMinutes()).padStart(2, '0')}`;
            document.getElementById('schedule-calendar-type').value = schedule.purpose;
            document.getElementById('schedule-client').value = schedule.client_id || '';
            document.getElementById('schedule-store').value = schedule.store_name || '';
            document.getElementById('schedule-address').value = schedule.address || '';
            document.getElementById('schedule-notes').value = schedule.notes || '';
          }
        } else {
          modalTitle.textContent = 'スケジュールを作成';
          deleteBtn.classList.add('hidden');
          if (dateStr) {
            document.getElementById('schedule-date').value = dateStr;
          }
          if (defaultTime) {
            document.getElementById('schedule-time-start').value = defaultTime;
            const [hour, min] = defaultTime.split(':');
            const endTime = new Date(`2000-01-01T${hour}:${min}`);
            endTime.setHours(endTime.getHours() + 1);
            document.getElementById('schedule-time-end').value = `${String(endTime.getHours()).padStart(2, '0')}:${String(endTime.getMinutes()).padStart(2, '0')}`;
          }
        }
        
        modal.classList.remove('hidden');
      }
      
      function closeScheduleModal() {
        document.getElementById('schedule-modal').classList.add('hidden');
      }
      
      function handleScheduleSubmit(e) {
        e.preventDefault();
        const formData = new FormData(e.target);
        const scheduleId = formData.get('id');
        
        const schedule = {
          id: scheduleId || `schedule-${Date.now()}`,
          date: formData.get('date'),
          time: formData.get('time_start'),
          client_id: formData.get('client_id'),
          client_name: getClientName(formData.get('client_id')) || formData.get('title'),
          store_name: formData.get('store_name'),
          purpose: formData.get('calendar_type'),
          address: formData.get('address'),
          notes: formData.get('notes'),
          status: 'upcoming'
        };
        
        if (scheduleId) {
          const index = schedules.findIndex(s => s.id === scheduleId);
          if (index !== -1) {
            schedules[index] = schedule;
          }
        } else {
          schedules.push(schedule);
        }
        
        closeScheduleModal();
        renderCurrentView();
        alert('スケジュールを保存しました');
      }
      
      function handleScheduleDelete() {
        const scheduleId = document.getElementById('schedule-id').value;
        if (!scheduleId) return;
        
        if (confirm('このスケジュールを削除しますか？')) {
          schedules = schedules.filter(s => s.id !== scheduleId);
          closeScheduleModal();
          renderCurrentView();
          alert('スケジュールを削除しました');
        }
      }
      
      function populateClientSelect() {
        const select = document.getElementById('schedule-client');
        select.innerHTML = '<option value="">選択してください</option>';
        
        if (clientsData.clients) {
          clientsData.clients.forEach(client => {
            const option = document.createElement('option');
            option.value = client.id;
            option.textContent = client.company_name;
            select.appendChild(option);
          });
        }
      }
      
      function getClientName(clientId) {
        if (!clientsData.clients) return '';
        const client = clientsData.clients.find(c => c.id === clientId);
        return client ? client.company_name : '';
      }
      
      function getStartOfWeek(date) {
        const d = new Date(date);
        const day = d.getDay();
        const diff = d.getDate() - day;
        return new Date(d.setDate(diff));
      }
      
      function formatDate(date) {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
      }
      
      function formatDateDisplay(date) {
        const year = date.getFullYear();
        const month = date.getMonth() + 1;
        const day = date.getDate();
        return `${year}年${month}月${day}日`;
      }
    })();
  </script>
</main>

    </main>
    <footer class="site-footer">
  <div class="container text-center muted small" style="padding: 16px 0;">
    <p>&copy; 2025 ミセサポ</p>
  </div>
</footer>


    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="/js/firebase-config.js"></script>
    <script src="/js/role_config.js"></script>
    <script src="/js/users.js"></script>
    <script src="/js/auth.js"></script>
    <script src="/js/navigation.js"></script>
    <script src="/modal_manager.js"></script>
    <script src="/app.js"></script>
    <script>
      // ログイン画面では通常ヘッダーを表示
      (function() {
        const path = window.location.pathname || '';
        const isSigninPage = path.includes('/signin.html') || path.includes('/signin');
        
        // ログイン画面では通常ヘッダーを表示、デフォルトヘッダーを非表示
        if (isSigninPage) {
          const defaultHeaderWrapper = document.getElementById('default-header-wrapper');
          const normalHeaderWrapper = document.getElementById('normal-header-wrapper');
          if (defaultHeaderWrapper) {
            defaultHeaderWrapper.style.display = 'none';
          }
          if (normalHeaderWrapper) {
            normalHeaderWrapper.style.display = 'block';
            // ログイン画面では通常ヘッダーを常に表示
            const normalHeader = normalHeaderWrapper.querySelector('.normal-header');
            if (normalHeader) {
              normalHeader.classList.add('visible');
            }
          }
        }
      })();
    </script>
  </body>
  </html>


