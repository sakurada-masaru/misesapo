# NFCタグ × レポート自動生成システム - 提案書

## 📋 エグゼクティブサマリー

本提案は、NFCタグとQRコードを活用した清掃業務の自動化システムです。清掃員が各清掃箇所でNFCタグを読み取ることで、作業記録とレポート作成を自動化し、業務効率化とデータ管理の質向上を実現します。

## 🎯 提案の背景

### 現状の課題

1. **レポート作成の手間**
   - 清掃員が全ての場所を回って、最後に一括でレポート作成
   - 写真とコメントを手動で整理・分類
   - 時間がかかり、ミスが発生しやすい

2. **データ管理の非効率**
   - 場所ごとのデータが手動で分類される
   - データの整合性が保たれにくい
   - 複数の清掃員のデータを統合するのが困難

3. **作業記録の不正確性**
   - 記憶に頼る部分が多い
   - 場所とデータの紐付けが不確実
   - 作業時間の記録が不正確

### 解決策

NFCタグとQRコードを活用した自動化システムにより、以下の課題を解決します：

- **自動化による効率化**: タグ読み取りだけで場所情報を自動取得
- **データの正確性向上**: その場で記録することで、記憶違いや漏れを防止
- **レポート作成の自動化**: 入力されたデータが自動的にレポートに統合

## 🏗️ システム概要

### システム構成

```
┌─────────────────┐
│  清掃前ミーティング  │
│  QRコード読み取り   │
│  清掃案件ID保存     │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  清掃開始        │
│  NFCタグ読み取り  │
│  打刻処理        │
│  フォーム表示     │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  清掃作業        │
│  写真撮影        │
│  コメント入力     │
└────────┬────────┘
         │
         ▼
┌─────────────────┐
│  清掃終了        │
│  レポート送信     │
│  タグ返却        │
└─────────────────┘
```

### 技術スタック

- **フロントエンド**: HTML5, JavaScript, QRコードスキャンライブラリ
- **バックエンド**: AWS Lambda (Python)
- **データベース**: AWS DynamoDB
- **ストレージ**: AWS S3
- **API**: AWS API Gateway
- **認証**: AWS Cognito

## 📊 業務フロー

### 1. 清掃前ミーティング

**目的**: 清掃案件IDを清掃員に伝達

**手順**:
1. リーダーが清掃案件IDのQRコードを提示
2. 清掃員がスマートフォンでQRコードを読み取り
3. 清掃案件IDを`localStorage`に自動保存

**技術的実装**:
- QRコードスキャン機能（HTML5-QRCodeライブラリ）
- `localStorage`への自動保存
- 読み取り確認画面の表示

### 2. 清掃開始（各清掃箇所で）

**目的**: 作業開始を記録し、フォームを表示

**手順**:
1. 清掃箇所のNFCタグを読み取る
2. タグIDから場所情報を自動取得（DynamoDB）
3. `localStorage`から清掃案件IDを自動取得
4. 打刻処理を実行（開始時刻記録）
5. フォームを表示（写真・コメント入力）

**技術的実装**:
- NFCタグ読み取り（iPhoneの標準機能）
- タグ情報取得API（`GET /staff/nfc/tag?tag_id=XXX`）
- 打刻処理API（`POST /staff/nfc/clock-in`）
- フォーム表示ページ（`/staff/nfc-location-form.html`）

### 3. 清掃作業

**目的**: 作業内容を記録

**手順**:
1. 清掃作業を実施
2. 写真を撮影（複数枚可）
3. コメントを入力
4. 送信ボタンを押す

**技術的実装**:
- 写真アップロード（S3への直接アップロード）
- コメント入力バリデーション
- 下書きレポートへの自動追加

### 4. 清掃終了（各清掃箇所で）

**目的**: 作業完了を記録し、レポートを送信

**手順**:
1. 清掃完了後、同じNFCタグを再度読み取る
2. 写真・コメントを確認・追加
3. レポート送信（清掃案件IDに自動紐づけ）
4. 終了時刻を記録

**技術的実装**:
- レポート送信API（`POST /staff/reports/draft/sections`）
- 清掃案件IDとの自動紐づけ
- 終了時刻の自動記録

### 5. タグ返却・清掃終了ｊ

**手順**:
1. 清掃員がタグをリーダーに返却
2. リーダーがタグ回収を確認
3. レポート作成完了を確認
4. 清掃終了

**技術的実装**:
- タグ回収状況の記録（将来的に実装）
- レポート完成状況の確認

## 💾 データ構造

### 清掃案件ID（localStorage）

```javascript
{
  schedule_id: "SCHEDULE_001",
  store_name: "新宿店",
  cleaning_date: "2025-01-15",
  saved_at: "2025-01-15T09:00:00Z"
}
```

### レポートデータ（DynamoDB）

```json
{
  "report_id": "RPT_001",
  "schedule_id": "SCHEDULE_001",  // ← 清掃案件ID（必須）
  "user_id": "WKR_001",
  "store_id": "STORE_001",
  "store_name": "新宿店",
  "cleaning_date": "2025-01-15",
  "sections": [
    {
      "section_id": "section-1",
      "location_id": "TOILET_001",
      "location_name": "トイレ入口",
      "photos": [
        {
          "url": "https://s3.../photo1.jpg",
          "uploaded_at": "2025-01-15T10:30:00Z"
        }
      ],
      "comment": "トイレ清掃完了",
      "start_time": "10:00:00",
      "end_time": "10:30:00",
      "created_at": "2025-01-15T10:30:00Z"
    }
  ],
  "status": "draft",
  "created_at": "2025-01-15T09:00:00Z",
  "updated_at": "2025-01-15T10:30:00Z"
}
```

### NFCタグ情報（DynamoDB）

```json
{
  "tag_id": "TOILET_001",
  "facility_id": "ABC_001",
  "location_id": "TK_R01_TOILET_IN",
  "facility_name": "新宿店",
  "location_name": "トイレ入口",
  "description": "1階トイレ入口",
  "created_at": "2025-01-15T10:00:00Z",
  "updated_at": "2025-01-15T10:00:00Z"
}
```

## ✅ メリット

### 1. 業務効率化

- **時間短縮**: レポート作成時間を大幅に削減
- **手作業削減**: 手動入力が不要になり、ミスが減少
- **自動化**: タグ読み取りだけで場所情報を自動取得

### 2. データの正確性向上

- **その場で記録**: 記憶に頼らず、その場で記録
- **自動紐づけ**: 清掃案件IDと場所情報の自動紐づけ
- **整合性**: データの整合性が保たれる

### 3. 作業管理の改善

- **進捗管理**: タグの配布・回収で作業進捗を可視化
- **作業漏れ防止**: タグの存在で作業箇所を確認
- **報酬管理**: タグ回収とレポート作成の紐付けで報酬計算が明確

### 4. 拡張性

- **将来的な機能追加**: 作業時間、薬剤使用、清掃工程などのデータも取得可能
- **データ分析**: 収集したデータを分析し、業務改善に活用
- **見積もり精度向上**: 過去データに基づく正確な見積もり

## ⚠️ デメリット・リスク

### 1. タグ管理の負荷

**課題**:
- タグの配布・回収の手間
- タグの紛失・破損のリスク
- 清掃箇所が増えると管理が複雑化

**対策**:
- タグ管理システムの導入（デジタル管理）
- QRコードの併用（タグが読み取れない場合の代替手段）
- 防水・防汚仕様のタグを使用

### 2. オフライン対応

**課題**:
- ネットワーク不調時の対応
- データの送信失敗

**対策**:
- ローカルストレージに一時保存
- オンライン復帰時に自動アップロード
- エラーハンドリングの強化

### 3. 清掃案件IDの管理

**課題**:
- QRコード読み取り漏れ
- 入力ミス

**対策**:
- 読み取り確認画面の表示
- レポート送信前のバリデーション
- 清掃案件ID未設定時の警告

### 4. 初期コスト

**課題**:
- NFCタグの購入コスト
- システム開発コスト

**対策**:
- 段階的な導入（まずは一部の清掃箇所から）
- 既存インフラの活用（AWSサービス）

## 📅 実装プラン

### Phase 1: 基盤整備（1-2週間）

**目的**: システムの基盤を構築

**実装内容**:
- DynamoDBテーブルの拡張（`nfc-tags`, `reports-draft`）
- Lambda関数の実装（下書きレポート管理）
- API Gatewayエンドポイントの追加

**成果物**:
- データベース構造
- API仕様書
- テスト結果

### Phase 2: NFCタグ読み取りフォーム（2-3週間）

**目的**: タグ読み取りとフォーム表示機能を実装

**実装内容**:
- QRコード読み取り機能
- NFCタグ読み取り処理
- 場所専用フォームページ
- 写真アップロード機能

**成果物**:
- QRコード読み取り画面
- NFCタグ読み取りフォーム
- 写真アップロード機能

### Phase 3: レポート統合機能（2-3週間）

**目的**: レポート作成と統合機能を実装

**実装内容**:
- 下書きレポートからセクションを読み込み
- レポート完成処理
- 清掃案件IDとの紐づけ

**成果物**:
- レポート作成画面の拡張
- レポート統合機能
- バリデーション機能

### Phase 4: UI/UX改善（1-2週間）

**目的**: ユーザビリティの向上

**実装内容**:
- フォームUIの改善
- エラーハンドリングの強化
- 進捗表示の追加

**成果物**:
- 改善されたUI
- エラーハンドリング仕様
- ユーザーテスト結果

### Phase 5: テストと改善（1-2週間）

**目的**: システムの品質向上

**実装内容**:
- 機能テスト
- パフォーマンステスト
- ユーザーテスト
- 改善対応

**成果物**:
- テスト結果レポート
- 改善対応リスト
- 運用マニュアル

**合計期間**: 7-12週間（約2-3ヶ月）

## 💰 コスト試算

### 初期コスト

| 項目 | 数量 | 単価 | 合計 |
|------|------|------|------|
| NFCタグ | 50枚 | ¥200 | ¥10,000 |
| システム開発 | - | - | 内部リソース |
| **合計** | - | - | **¥10,000** |

### 運用コスト（月額）

| 項目 | 料金 |
|------|------|
| AWS Lambda | ¥500-1,000 |
| DynamoDB | ¥1,000-2,000 |
| S3 | ¥500-1,000 |
| API Gateway | ¥500-1,000 |
| **合計** | **¥2,500-5,000/月** |

### ROI（投資対効果）

**削減できる時間**:
- レポート作成時間: 1日あたり30分 × 20日 = 10時間/月
- データ整理時間: 1日あたり15分 × 20日 = 5時間/月
- **合計: 15時間/月**

**削減できるコスト**（時給¥1,500と仮定）:
- 15時間 × ¥1,500 = **¥22,500/月**

**ROI**:
- 初期コスト: ¥10,000
- 月額削減: ¥22,500
- **投資回収期間: 約0.5ヶ月**

## 📈 期待される効果

### 短期的効果（3ヶ月以内）

1. **レポート作成時間の削減**: 30分/日 → 10分/日（約67%削減）
2. **データ入力ミスの削減**: 90%削減
3. **作業記録の正確性向上**: 95%以上

### 中期的効果（6ヶ月以内）

1. **作業効率の向上**: 20%向上
2. **データ分析の開始**: 作業時間、薬剤使用などのデータ分析
3. **見積もり精度の向上**: 過去データに基づく正確な見積もり

### 長期的効果（1年以内）

1. **業務プロセスの最適化**: データ分析に基づく業務改善
2. **コスト削減**: 作業効率向上によるコスト削減
3. **顧客満足度の向上**: 正確なレポートによる信頼性向上

## 🎯 成功指標（KPI）

### 定量指標

- **レポート作成時間**: 30分/日 → 10分/日
- **データ入力ミス率**: 10% → 1%以下
- **作業記録の正確性**: 80% → 95%以上
- **タグ読み取り成功率**: 95%以上

### 定性指標

- **清掃員の満足度**: アンケート調査
- **管理者の満足度**: アンケート調査
- **顧客満足度**: レポート品質の向上

## 🚀 次のステップ

### 承認後のアクション

1. **プロジェクトキックオフ**: 関係者を集めてキックオフミーティング
2. **Phase 1開始**: 基盤整備から実装開始
3. **定期的な進捗報告**: 週次で進捗を報告

### 検討事項

1. **パイロット運用**: 一部の清掃箇所でパイロット運用を実施
2. **ユーザーフィードバック**: パイロット運用中にフィードバックを収集
3. **本格運用**: パイロット運用の結果を踏まえて本格運用

## 📚 参考資料

- [NFCタグ打刻システム - セットアップガイド](./NFC_CLOCK_IN_SETUP.md)
- [NFCタグ × レポート自動生成システム - 実装プラン](./NFC_TAG_REPORT_INTEGRATION_PLAN.md)
- [NFCタグトリガー方式セットアップガイド](./NFC_TAG_TRIGGER_SETUP.md)

## 📝 まとめ

本提案は、NFCタグとQRコードを活用した清掃業務の自動化システムです。以下の点で優れています：

1. **業務効率化**: レポート作成時間を大幅に削減
2. **データの正確性向上**: その場で記録することで、記憶違いや漏れを防止
3. **拡張性**: 将来的に作業時間、薬剤使用などのデータも取得可能
4. **投資対効果**: 初期コスト¥10,000、月額削減¥22,500で、投資回収期間は約0.5ヶ月

段階的な実装により、リスクを最小限に抑えながら、確実に効果を実現できます。

---

**提案日**: 2025年1月15日  
**提案者**: 開発チーム  
**承認**: [ ] 承認 [ ] 保留 [ ] 却下

