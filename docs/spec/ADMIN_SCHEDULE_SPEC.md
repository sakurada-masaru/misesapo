# 清掃スケジュール・予約管理 仕様

管理（admin）配下の清掃スケジュール（予約管理）の仕様です。週表示は廃止し、タイムラインのみです。

---

## 1. 概要

- **場所**: MISOGI の admin（`src/misogi/pages/admin/pages/`）
- **URL**: `/admin/schedule`
- **入口**: 管理エントランス `/admin/entrance` のホットバー「清掃スケジュール」→ `/admin/schedule`
- **画面**: 病院型タイムライン（日付×時間枠、一覧、月表示、モーダルで割当の新規・編集・削除）

---

## 2. 機能

- **表示切替**: 「タイムライン」「一覧」「月（簡易）」の3モード。
- **日付**: 前日/今日/翌日ボタン、または日付入力で変更。対象日の予約のみ表示。
- **タイムライン（日）**:
  - PC: 清掃員ごとに列、時間軸は 9:00〜18:00・15分刻み。各列に割当カードを配置。
  - SP: 清掃員タブで1人選択し、その人のタイムスロット＋カードを縦に表示。
- **割当カード**: 開始〜終了時刻、現場名、作業種別、状態を表示。クリックで詳細モーダル。
- **一覧**: 時間順のテーブル（時間・現場・清掃員・種別・状態・重複注意）。
- **月表示**: 簡易月カレンダー。日付クリックでその日を選択。
- **フィルタ**: 検索（現場名/作業種別/清掃員）、清掃員・状態・種別のセレクト。
- **重複検知**: 同一清掃員で時間が重なる割当に「重複⚠」表示。
- **モーダル**: 割当の新規作成・編集・削除。開始/終了時刻、現場名、種別、状態、メモを編集可能。
- **FAB**: 「今日」ボタンと「＋」（新規割当）。980px以上では非表示（ヘッダーの「＋ 割当追加」を使用）。

---

## 3. データモデル（localStorage）

| キー | 内容 |
|------|------|
| `admin-schedule-appointments` | 割当（予約）の配列。1件 = `{ id, date, cleaner_id, start_min, end_min, target_name, work_type, status, memo, created_at }` |
| `admin-schedule-cleaners` | 清掃員一覧。`[{ id, name }, ...]` |

- **状態（status）**: `booked`（予約）, `checked_in`（受付済）, `in_progress`（作業中）, `done`（完了）, `cancelled`（キャンセル）。色分け表示。
- **作業種別（work_type）**: 定期、特別、入念、検査対応、夜間、その他。
- 初回は当日分のサンプル割当が自動生成される（localStorage が空の場合）。

---

## 4. UI

- 上部: ビジュアライザー。「← 管理エントランス」で `/admin/entrance` に戻る。
- ヘッダー: 日付・前日/今日/翌日・＋割当追加、日付入力・検索・表示切替・フィルタ・合計/状態別のピル。
- メイン: タイムライン or 一覧 or 月。PC/SP でレイアウト切替（980px 境界）。
- テーマ: 指定のダークテーマ（--bg, --panel, --panel2, --text, --muted, --line, --shadow）をページ内で適用。

---

## 5. ルート・フルスクリーン

- `/admin/schedule` … AdminScheduleTimelinePage（タイムライン＝予約管理）
- App のフルスクリーン対象（ヘッダー/ナビ非表示で表示）。

---

## 6. 今後の拡張（未実装）

- バックエンド API 化（現状は localStorage のみ）
- ワーカー管理・カルテ管理はホットバーに枠ありだが disabled
