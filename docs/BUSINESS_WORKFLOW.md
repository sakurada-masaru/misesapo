# 業務フロー（MISESAPO）— スケジュール〜レポート〜請求〜報酬確定

## 概要

本ドキュメントは、MISESAPO における「案件の発生〜清掃〜レポート〜請求〜サイン〜報酬確定」までの一連の業務フローを、関係者（お客様・営業・管理・清掃員）と成果物（スケジュール・レポート・見積/請求・サイン）に分解して整理する。

フロー（起点→終点）:

**お客様 → 営業 → 管理 → 清掃員 → 管理 → 営業 → お客様**

---

## 用語（この文書内での意味）

- **お客様**: サービス提供先（法人/ブランド/店舗）。
- **営業**: お客様対応・案件締結・請求書提出を担う。
- **管理**: スケジュール確認、清掃員への割当、レポート/提案事項の確認、見積資料の添付、請求書作成、サイン確認、報酬確定を担う。
- **清掃員**: 作業の実施、レポート作成、次回提案事項の作成を担う。

---

## 全体フロー（箇条書き）

1. **お客様からのご依頼を営業が案件として締結**
2. **営業がスケジュールを入力**
3. **管理がスケジュール確認**
4. **管理が清掃員に作業を割り当て**
5. **清掃員がスケジュール確認**
6. **清掃実施**
7. **清掃員がレポート、次回提案事項を作成**
8. **管理がレポート、次回提案事項を確認し、見積もり資料を加え請求書を作成**
9. **営業が請求書をお客様に提出**
10. **お客様がレポート確認、清掃完了にサイン**
11. **管理がサインを確認し、清掃員の報酬を確定**
12. **清掃員に給料発生**

---

## 役割別（責務と出力）

### お客様

- **入力/依頼**: 依頼内容（対象店舗・希望日時・要件）
- **確認**: レポート内容の確認
- **承認**: 清掃完了のサイン（完了承認）

### 営業

- **案件締結**: 依頼を案件として成立させる（契約/合意）
- **スケジュール入力**: 実施予定（日時・対象店舗・清掃内容の大枠）を登録
- **請求書提出**: 管理が作成した請求書をお客様へ提出

### 管理

- **スケジュール確認**: 営業入力の内容の整合性確認
- **作業割当**: 清掃員のアサイン、必要に応じて日時/内容調整
- **レポート/提案事項確認**: 清掃員が作成した内容の確認
- **請求書作成**: レポート＋見積資料を加えて請求書を作成
- **サイン確認**: お客様の完了サインを確認
- **報酬確定**: サイン確認後に清掃員報酬を確定

### 清掃員

- **スケジュール確認**: 割り当てられた作業の内容確認
- **清掃実施**: 現地作業
- **レポート作成**: 作業結果・写真・コメント等
- **次回提案事項作成**: 次回改善提案・追加作業提案

---

## 成果物（何がいつ生まれるか）

- **スケジュール**（営業入力 → 管理確認 → 清掃員割当）
  - 主な情報: 店舗、日時、作業時間、清掃内容、担当者（営業/清掃員）、ステータス
- **清掃レポート**（清掃員作成 → 管理確認 → お客様閲覧/承認）
  - 主な情報: 清掃項目、写真、コメント、次回提案事項
- **見積資料**（管理が必要に応じて添付）
- **請求書**（管理作成 → 営業提出）
- **完了サイン**（お客様が付与 → 管理が確認）
- **報酬確定**（管理が確定 → 給与発生）

---

## ステータス（案：運用をシステムに落とすための整理）

現状の画面/実装に合わせて、最低限以下のステータスを扱う前提で運用を整理する。

### スケジュール

- **draft（未確定）**: 営業入力直後 / まだ管理承認・割当が完了していない
- **scheduled（確定）**: 管理確認済み、作業の実施予定として確定
- **in_progress（作業中）**: 清掃当日〜作業中
- **completed（完了）**: 清掃作業が完了（※サイン確認の扱いは下記参照）
- **cancelled（キャンセル）**: 実施中止

> 注: 「お客様のサイン確認」や「報酬確定」は、スケジュールの `completed` と別レイヤー（承認/請求/支払）で管理する方が安全（fail safely）になりやすい。

### レポート（参考）

- **draft**: 清掃員作成中
- **submitted**: 清掃員提出済み（管理確認待ち）
- **reviewed**: 管理確認済み（請求書作成へ）
- **shared**: お客様へ共有/閲覧可能
- **signed**: お客様サイン済み（報酬確定へ）

---

## 補足（システム設計に落とすときの論点）

- **1スケジュールに対するレポート数**: 1件か、清掃項目ごと複数か（将来要件）
- **サインの保存先**: サイン画像/署名情報、サイン日時、サイン者（お客様担当）をどこで保持するか
- **報酬確定のトリガー**: サイン確認後に自動/手動どちらで確定するか
- **例外フロー**: 当日キャンセル、再訪、やり直し、差し戻し（レポート修正）など


